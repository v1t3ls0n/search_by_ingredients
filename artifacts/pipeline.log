================================================================================
DIET CLASSIFIER PIPELINE - LOG INITIALIZED
================================================================================
13:41:54 â”‚ INFO â”‚ Logging system initialized successfully
13:42:16 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
13:42:16 â”‚ INFO â”‚ Carb map initialised (303 keys)
13:44:49 â”‚ INFO â”‚       ğŸ“Š Silver Labels Generated:
13:44:49 â”‚ INFO â”‚       â”œâ”€ Total recipes: 225,602
13:44:49 â”‚ INFO â”‚       â”œâ”€ Keto positive: 36,722 (16.3%)
13:44:49 â”‚ INFO â”‚       â”œâ”€ Vegan positive: 16,378 (7.3%)
13:44:49 â”‚ INFO â”‚       â”œâ”€ With photos: 225,602 (100.0%)
13:44:49 â”‚ INFO â”‚       â””â”€ Generation time: 188.3s
13:44:49 â”‚ INFO â”‚    âœ… Silver labels generated successfully in 188.5s
13:44:49 â”‚ INFO â”‚       ğŸ’¾ Silver labels generated: 84.8% memory used (2899 MB / 3815 MB)
13:44:49 â”‚ INFO â”‚ 
   âœ… STAGE 4: DATA VALIDATION AND CROSS-CHECKS
13:44:50 â”‚ INFO â”‚       ğŸ’¾ Memory Usage by Dataset:
13:44:50 â”‚ INFO â”‚       â”œâ”€ Recipes: 145.4 MB
13:44:50 â”‚ INFO â”‚       â”œâ”€ Silver: 106.4 MB
13:44:50 â”‚ INFO â”‚       â”œâ”€ Ground_truth: 0.1 MB
13:44:50 â”‚ INFO â”‚       â””â”€ Total: 251.9 MB
13:44:50 â”‚ INFO â”‚       ğŸ“Š Label Distribution Comparison:
13:44:50 â”‚ INFO â”‚       â”œâ”€ Keto: Gold=40.0%, Silver=16.3%
13:44:50 â”‚ INFO â”‚       â””â”€ Vegan: Gold=40.0%, Silver=7.3%
13:44:50 â”‚ WARNING â”‚       âš ï¸  Large keto distribution difference: 23.7%
13:44:50 â”‚ WARNING â”‚       âš ï¸  Large vegan distribution difference: 32.7%
13:44:50 â”‚ INFO â”‚       âœ… Validation Summary:
13:44:50 â”‚ INFO â”‚       â”œâ”€ Recipes Loaded: âœ…
13:44:50 â”‚ INFO â”‚       â”œâ”€ Ground Truth Loaded: âœ…
13:44:50 â”‚ INFO â”‚       â”œâ”€ Silver Generated: âœ…
13:44:50 â”‚ INFO â”‚       â”œâ”€ Required Columns Present: âœ…
13:44:50 â”‚ INFO â”‚       â”œâ”€ Labels Processed: âœ…
13:44:50 â”‚ INFO â”‚       â”œâ”€ Consistency Issues: 0
13:44:50 â”‚ INFO â”‚    âœ… Data validation completed in 0.9s
13:44:50 â”‚ INFO â”‚       ğŸ’¾ Validation complete: 84.9% memory used (2903 MB / 3815 MB)
13:44:50 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
13:44:50 â”‚ INFO â”‚    âœ… USDA table loaded in 0.2s â€“ 303 rows
13:44:50 â”‚ INFO â”‚ 
ğŸ DATASET LOADING COMPLETE
13:44:50 â”‚ INFO â”‚    â”œâ”€ Total loading time: 207.6s
13:44:50 â”‚ INFO â”‚    â”œâ”€ Datasets loaded: 4 (recipes, ground_truth, silver, usda)
13:44:50 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
13:44:50 â”‚ INFO â”‚    â””â”€ All validations passed: âœ…
13:44:50 â”‚ INFO â”‚ 
   ğŸ“‹ Final Dataset Summary:
13:44:50 â”‚ INFO â”‚    â”œâ”€ Recipes: 225,602 rows Ã— 5 columns
13:44:50 â”‚ INFO â”‚    â”œâ”€ Ground Truth: 100 rows Ã— 10 columns
13:44:50 â”‚ INFO â”‚    â”œâ”€ Silver Labels: 225,602 rows Ã— 5 columns
13:44:50 â”‚ INFO â”‚    â”œâ”€ USDA Carb Tbl:  303 rows Ã— 2 columns (0.0 MB)
13:44:50 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
13:44:50 â”‚ INFO â”‚    â””â”€ Ready for ML pipeline: âœ…
13:44:51 â”‚ INFO â”‚ 
   ğŸ“Š Dataset Statistics:
13:44:51 â”‚ INFO â”‚    â”œâ”€ Silver (All): 225,602 recipes
13:44:51 â”‚ INFO â”‚    â”œâ”€ Silver (Text): 225,602 recipes
13:44:51 â”‚ INFO â”‚    â”œâ”€ Silver (Images): 72,485 recipes
13:44:51 â”‚ INFO â”‚    â”œâ”€ Gold (All): 100 recipes
13:44:51 â”‚ INFO â”‚    â””â”€ Gold (Images): 66 recipes
13:44:51 â”‚ INFO â”‚ 
   âš–ï¸  Class Balance Analysis:
13:44:51 â”‚ INFO â”‚    âœ… Data loading completed in 208.5s
13:44:51 â”‚ INFO â”‚    ğŸ“Š Data Loading - Memory: 85.4% used (2922 MB / 3815 MB)
13:44:51 â”‚ INFO â”‚    ğŸ§¹ Data Loading: Memory cleanup
13:44:51 â”‚ INFO â”‚       â”œâ”€ RAM: 85.4% used (2921 MB)
13:44:51 â”‚ INFO â”‚       â”œâ”€ RAM freed: 1.1 MB
13:44:51 â”‚ WARNING â”‚       âš ï¸  High memory usage: 85.4%
13:44:51 â”‚ WARNING â”‚ High memory usage after data loading: 85.4%
13:44:51 â”‚ INFO â”‚ 
ğŸ”¤ STAGE 2: TEXT FEATURE PROCESSING
13:44:51 â”‚ INFO â”‚    â”œâ”€ Vectorizer config: {'min_df': 2, 'ngram_range': (1, 3), 'max_features': 50000, 'sublinear_tf': True}
13:44:52 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
13:44:52 â”‚ INFO â”‚    â”œâ”€ USDA examples added: 303
13:45:23 â”‚ INFO â”‚    ğŸ“Š Text Processing Results:
13:45:23 â”‚ INFO â”‚    â”œâ”€ Vocabulary size: 50,000
13:45:23 â”‚ INFO â”‚    â”œâ”€ Silver features: (225905, 50000)
13:45:23 â”‚ INFO â”‚    â”œâ”€ Gold features: (100, 50000)
13:45:23 â”‚ INFO â”‚    â”œâ”€ Sparsity: 0.0%
13:45:23 â”‚ INFO â”‚    â””â”€ Memory usage: ~103 MB
13:45:23 â”‚ INFO â”‚    âœ… Text processing completed in 31.5s
13:45:23 â”‚ INFO â”‚    ğŸ“Š Text Processing - Memory: 87.0% used (2985 MB / 3815 MB)
13:45:23 â”‚ INFO â”‚    ğŸ§¹ Text Processing: Memory cleanup
13:45:23 â”‚ INFO â”‚       â”œâ”€ RAM: 87.0% used (2985 MB)
13:45:23 â”‚ WARNING â”‚       âš ï¸  High memory usage: 87.0%
13:45:23 â”‚ INFO â”‚ 
ğŸ–¼ï¸  STAGE 3: IMAGE FEATURE PROCESSING
13:45:23 â”‚ INFO â”‚    â”œâ”€ Processing 72,485 sampled silver images
13:45:23 â”‚ INFO â”‚    â””â”€ Processing 66 gold images
13:45:23 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: silver
13:45:23 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/silver
13:45:23 â”‚ INFO â”‚    Total samples: 72,485
13:45:23 â”‚ INFO â”‚    Force recompute: False
13:45:23 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
13:45:23 â”‚ INFO â”‚    âŒ No suitable embeddings found - proceeding with downloads
13:45:23 â”‚ INFO â”‚ 
   ğŸ“‹ DOWNLOAD PLANNING:
13:45:28 â”‚ INFO â”‚       ğŸ“Š Analysis Results:
13:45:28 â”‚ INFO â”‚       â”œâ”€ Total samples: 72,485
13:45:28 â”‚ INFO â”‚       â”œâ”€ Existing valid files: 0
13:45:28 â”‚ INFO â”‚       â”œâ”€ Corrupted files cleaned: 0
13:45:28 â”‚ INFO â”‚       â”œâ”€ Valid URLs to download: 72,485
13:45:28 â”‚ INFO â”‚       â”œâ”€ Missing URLs: 0
13:45:28 â”‚ INFO â”‚       â””â”€ Invalid URLs: 0
13:45:28 â”‚ WARNING â”‚    âš ï¸  Large download required: 72,485 files
13:45:28 â”‚ INFO â”‚       â””â”€ This may take a while...
13:45:28 â”‚ INFO â”‚    ğŸ¯ Download Queue: 72,485 files
13:45:28 â”‚ INFO â”‚ 
   ğŸš€ EXECUTING ROBUST DOWNLOADS:
14:41:43 â”‚ INFO â”‚ 
   ğŸ“Š DOWNLOAD RESULTS:
14:41:43 â”‚ INFO â”‚    â”œâ”€ Processing time: 3380.1s
14:41:44 â”‚ INFO â”‚    â”œâ”€ Files downloaded: 70,732
14:41:44 â”‚ INFO â”‚    â”œâ”€ Files skipped: 0
14:41:44 â”‚ INFO â”‚    â”œâ”€ Download failures: 1,753
14:41:44 â”‚ INFO â”‚    â”œâ”€ Retry attempts: 16
14:41:44 â”‚ INFO â”‚    â””â”€ Data transferred: 2136.2 MB
14:41:44 â”‚ INFO â”‚ 
   ğŸ“ˆ SUCCESS METRICS:
14:41:44 â”‚ INFO â”‚    â”œâ”€ Download success rate: 97.6%
14:41:44 â”‚ INFO â”‚    â”œâ”€ Total valid files: 70,732
14:41:44 â”‚ INFO â”‚    â”œâ”€ Coverage: 97.6% of dataset
14:41:44 â”‚ INFO â”‚    âœ… ACCEPTABLE COVERAGE - proceeding with 70,732 images
14:42:06 â”‚ INFO â”‚       â”œâ”€ Silver download: 70,732/72,485 successful
14:42:06 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: gold
14:42:06 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/gold
14:42:06 â”‚ INFO â”‚    Total samples: 66
14:42:06 â”‚ INFO â”‚    Force recompute: False
14:42:06 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
14:42:06 â”‚ INFO â”‚    âŒ No suitable embeddings found - proceeding with downloads
14:42:06 â”‚ INFO â”‚ 
   ğŸ“‹ DOWNLOAD PLANNING:
14:42:06 â”‚ INFO â”‚       ğŸ“Š Analysis Results:
14:42:06 â”‚ INFO â”‚       â”œâ”€ Total samples: 66
14:42:06 â”‚ INFO â”‚       â”œâ”€ Existing valid files: 0
14:42:06 â”‚ INFO â”‚       â”œâ”€ Corrupted files cleaned: 0
14:42:06 â”‚ INFO â”‚       â”œâ”€ Valid URLs to download: 66
14:42:06 â”‚ INFO â”‚       â”œâ”€ Missing URLs: 0
14:42:06 â”‚ INFO â”‚       â””â”€ Invalid URLs: 0
14:42:06 â”‚ WARNING â”‚    âš ï¸  Large download required: 66 files
14:42:06 â”‚ INFO â”‚       â””â”€ This may take a while...
14:42:06 â”‚ INFO â”‚    ğŸ¯ Download Queue: 66 files
14:42:06 â”‚ INFO â”‚ 
   ğŸš€ EXECUTING ROBUST DOWNLOADS:
14:42:08 â”‚ INFO â”‚ 
   ğŸ“Š DOWNLOAD RESULTS:
14:42:08 â”‚ INFO â”‚    â”œâ”€ Processing time: 2.3s
14:42:08 â”‚ INFO â”‚    â”œâ”€ Files downloaded: 66
14:42:08 â”‚ INFO â”‚    â”œâ”€ Files skipped: 0
14:42:08 â”‚ INFO â”‚    â”œâ”€ Download failures: 0
14:42:08 â”‚ INFO â”‚    â”œâ”€ Retry attempts: 0
14:42:08 â”‚ INFO â”‚    â””â”€ Data transferred: 2.1 MB
14:42:08 â”‚ INFO â”‚ 
   ğŸ“ˆ SUCCESS METRICS:
14:42:08 â”‚ INFO â”‚    â”œâ”€ Download success rate: 100.0%
14:42:08 â”‚ INFO â”‚    â”œâ”€ Total valid files: 66
14:42:08 â”‚ INFO â”‚    â”œâ”€ Coverage: 100.0% of dataset
14:42:08 â”‚ INFO â”‚    âœ… ACCEPTABLE COVERAGE - proceeding with 66 images
14:42:08 â”‚ INFO â”‚       â”œâ”€ Gold download: 66/66 successful
14:42:09 â”‚ INFO â”‚       â”œâ”€ Silver filtered: 70,732 with valid images
14:42:09 â”‚ INFO â”‚       â”œâ”€ Gold filtered: 66 with valid images
14:42:09 â”‚ INFO â”‚       â”œâ”€ Gold filtered: 66 with valid images
14:42:09 â”‚ INFO â”‚ 
ğŸ§  IMAGE EMBEDDING EXTRACTION: silver
14:42:09 â”‚ INFO â”‚    Target images: 70,732
14:42:09 â”‚ INFO â”‚    Mode: silver
14:42:09 â”‚ INFO â”‚    Force recomputation: False
14:42:09 â”‚ INFO â”‚    ğŸ”§ Device Configuration:
14:42:09 â”‚ INFO â”‚    â”œâ”€ Device: cpu
14:42:09 â”‚ INFO â”‚    â”œâ”€ CUDA available: False
14:42:09 â”‚ INFO â”‚    â””â”€ Using CPU (warning: much slower)
14:42:09 â”‚ INFO â”‚    ğŸ“ Paths:
14:42:09 â”‚ INFO â”‚    â”œâ”€ Image directory: dataset/arg_max/images/silver
14:42:09 â”‚ INFO â”‚    â”œâ”€ Cache file: dataset/arg_max/images/silver/embeddings.npy
14:42:09 â”‚ INFO â”‚    â””â”€ Backup file: /app/artifacts/embeddings_silver_backup.npy
14:42:09 â”‚ INFO â”‚ 
   ğŸ” Cache Validation:
14:42:09 â”‚ INFO â”‚       â”œâ”€ Artifacts backup: Not found
14:42:09 â”‚ INFO â”‚       â”œâ”€ Primary cache: Not found
14:42:09 â”‚ INFO â”‚       â”œâ”€ Legacy backup: Not found
14:42:09 â”‚ INFO â”‚       â””â”€ No valid cache found - will compute embeddings
14:42:09 â”‚ INFO â”‚ 
   ğŸ“Š Pre-processing Analysis:
14:43:15 â”‚ INFO â”‚       ğŸ“ˆ Image Availability:
14:43:15 â”‚ INFO â”‚       â”œâ”€ Total expected: 70,732
14:43:15 â”‚ INFO â”‚       â”œâ”€ Available: 70,732 (100.0%)
14:43:15 â”‚ INFO â”‚       â”œâ”€ Missing: 0 (0.0%)
14:43:15 â”‚ INFO â”‚       â””â”€ Corrupted: 0 (0.0%)
14:43:15 â”‚ INFO â”‚       ğŸ“Š Sample Analysis (10 images):
14:43:15 â”‚ INFO â”‚       â”œâ”€ Average size: 436Ã—289 pixels
14:43:15 â”‚ INFO â”‚       â”œâ”€ Average file size: 31.8 KB
14:43:15 â”‚ INFO â”‚       â”œâ”€ Color modes: {'RGB': 10}
14:43:15 â”‚ INFO â”‚       â””â”€ Formats: {'JPEG': 10}
14:43:15 â”‚ INFO â”‚ 
   ğŸ¤– Model Setup:
14:44:57 â”‚ INFO â”‚       âœ… Model loaded in 101.31s
14:44:57 â”‚ INFO â”‚       â”œâ”€ Architecture: ResNet-50 (feature extractor)
14:44:57 â”‚ INFO â”‚       â”œâ”€ Output dimension: 2048
14:44:57 â”‚ INFO â”‚       â”œâ”€ Device: cpu
14:44:57 â”‚ INFO â”‚       â””â”€ Parameters: 23,508,032
14:44:57 â”‚ INFO â”‚ 
   âš¡ Feature Extraction:
14:44:57 â”‚ INFO â”‚       ğŸ”§ Processing Configuration:
14:44:57 â”‚ INFO â”‚       â”œâ”€ Batch size: 8
14:44:57 â”‚ INFO â”‚       â”œâ”€ Total batches: 8842
14:44:57 â”‚ INFO â”‚       â””â”€ Expected output shape: (70732, 2048)
14:47:51 â”‚ INFO â”‚    ğŸ§¹ Batch Processing: Memory cleanup
14:47:51 â”‚ INFO â”‚       â”œâ”€ RAM: 81.5% used (2770 MB)
14:47:51 â”‚ WARNING â”‚       âš ï¸  Moderate memory usage: 81.5%
