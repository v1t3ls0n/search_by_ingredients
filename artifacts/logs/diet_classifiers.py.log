
================================================================================
NEW RUN STARTED AT 2025-06-21 08:38:49
Process ID: 103
================================================================================
08:38:50 â”‚ INFO â”‚ Logging system initialized successfully
08:38:51 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
08:38:51 â”‚ INFO â”‚ Carb map initialised (303 keys)
08:38:51 â”‚ INFO â”‚ âœ… All sanity checks passed
08:38:51 â”‚ INFO â”‚ ğŸš€ Starting main with args: Namespace(ground_truth=None, train=True, ingredients=None, mode='both', force=False, sample_frac=1.0)
08:38:51 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
08:38:51 â”‚ INFO â”‚ Safe memory limit (90%): 28.1 GB
08:38:51 â”‚ INFO â”‚ ğŸ’¾ Available memory for processing: 28.1 GB
08:38:51 â”‚ WARNING â”‚ âš ï¸  Limited memory detected. Enabling memory optimizations...
08:38:51 â”‚ INFO â”‚ ğŸš€ Starting main with args: Namespace(ground_truth=None, train=True, ingredients=None, mode='both', force=False, sample_frac=1.0)
08:38:51 â”‚ INFO â”‚ ğŸ§  SINGLE training run - sample_frac=1.0
08:38:51 â”‚ INFO â”‚ ğŸš€ STARTING FULL ML PIPELINE
08:38:52 â”‚ INFO â”‚    Mode: both
08:38:52 â”‚ INFO â”‚    Force recomputation: False
08:38:52 â”‚ INFO â”‚    Sample fraction: 1.0
08:38:52 â”‚ INFO â”‚    Start time: 2025-06-21 08:38:52
08:38:52 â”‚ INFO â”‚    Available CPU cores: 24
08:38:52 â”‚ INFO â”‚    Available memory: 31 GB
08:38:52 â”‚ INFO â”‚ 
ğŸ“‚ STAGE 1: DATA LOADING AND PREPARATION
08:38:52 â”‚ INFO â”‚ 
ğŸ“‚ DATASET LOADING PIPELINE
08:38:52 â”‚ INFO â”‚    Configuration: 2 data sources
08:38:52 â”‚ INFO â”‚    Data directory: /app/data
08:38:52 â”‚ INFO â”‚    ğŸ“Š Data Sources:
08:38:52 â”‚ INFO â”‚    â”œâ”€ allrecipes.parquet: Local
08:38:52 â”‚ INFO â”‚    â”‚  â””â”€ /app/data/allrecipes.parquet
08:38:52 â”‚ INFO â”‚    â”œâ”€ ground_truth_sample.csv: Local
08:38:52 â”‚ INFO â”‚    â”‚  â””â”€ /app/data/ground_truth_sample.csv
08:38:52 â”‚ INFO â”‚ 
   ğŸ³ STAGE 1: LOADING RECIPES DATASET
08:38:52 â”‚ INFO â”‚    â”œâ”€ Source: /app/data/allrecipes.parquet
08:38:52 â”‚ INFO â”‚       â”œâ”€ Local file size: 49.2 MB
08:38:52 â”‚ INFO â”‚       ğŸ“Š Recipes Dataset:
08:38:52 â”‚ INFO â”‚       â”œâ”€ Shape: (225602, 5)
08:38:52 â”‚ INFO â”‚       â”œâ”€ Columns: ['title', 'description', 'instructions', 'ingredients', 'photo_url']
08:38:52 â”‚ INFO â”‚       â”œâ”€ Memory usage: 145.4 MB
08:38:52 â”‚ INFO â”‚       â””â”€ Load time: 0.5s
08:38:56 â”‚ INFO â”‚       ğŸ“ˆ Data Quality:
08:38:56 â”‚ INFO â”‚       â”œâ”€ Total recipes: 225,602
08:38:56 â”‚ INFO â”‚       â”œâ”€ Null ingredients: 0
08:38:56 â”‚ INFO â”‚       â”œâ”€ Empty ingredients: 0
08:38:56 â”‚ INFO â”‚       â””â”€ With photos: 225,602 (100.0%)
08:38:56 â”‚ INFO â”‚    âœ… Recipes loaded successfully in 4.0s
08:38:56 â”‚ INFO â”‚       ğŸ’¾ Recipes loaded: 14.4% memory used (3997 MB / 32015 MB)
08:38:56 â”‚ INFO â”‚ 
   ğŸ¯ STAGE 2: LOADING GROUND TRUTH DATASET
08:38:56 â”‚ INFO â”‚    â”œâ”€ Source: /app/data/ground_truth_sample.csv
08:38:56 â”‚ INFO â”‚       â”œâ”€ File size: 79.1 KB
08:38:56 â”‚ INFO â”‚       ğŸ“Š Ground Truth Dataset:
08:38:56 â”‚ INFO â”‚       â”œâ”€ Shape: (100, 7)
08:38:56 â”‚ INFO â”‚       â”œâ”€ Columns: ['title', 'description', 'instructions', 'ingredients', 'photo_url', 'vegan', 'keto']
08:38:56 â”‚ INFO â”‚       â”œâ”€ Keto columns found: ['keto']
08:38:56 â”‚ INFO â”‚       â”œâ”€ Vegan columns found: ['vegan']
08:38:56 â”‚ INFO â”‚       â””â”€ Load time: 0.01s
08:38:56 â”‚ INFO â”‚       â”œâ”€ Keto labels: 40/100 (40.0% positive)
08:38:56 â”‚ INFO â”‚       â”œâ”€ Vegan labels: 40/100 (40.0% positive)
08:38:56 â”‚ INFO â”‚    âœ… Ground truth loaded successfully in 0.1s
08:38:56 â”‚ INFO â”‚       ğŸ’¾ Ground truth loaded: 14.4% memory used (4003 MB / 32015 MB)
08:38:56 â”‚ INFO â”‚ 
   ğŸ¥ˆ STAGE 3: GENERATING SILVER LABELS

================================================================================
NEW RUN STARTED AT 2025-06-21 08:38:56
Process ID: 36
================================================================================
08:38:56 â”‚ INFO â”‚ Logging system initialized successfully
08:38:58 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
08:38:58 â”‚ INFO â”‚ Carb map initialised (303 keys)
08:38:58 â”‚ INFO â”‚ âœ… All sanity checks passed

================================================================================
NEW RUN STARTED AT 2025-06-21 08:39:01
Process ID: 160
================================================================================
08:39:01 â”‚ INFO â”‚ Logging system initialized successfully
08:39:03 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
08:39:03 â”‚ INFO â”‚ Carb map initialised (303 keys)
08:39:03 â”‚ INFO â”‚ âœ… All sanity checks passed
08:40:39 â”‚ INFO â”‚       ğŸ“Š Silver Labels Generated:
08:40:39 â”‚ INFO â”‚       â”œâ”€ Total recipes: 225,602
08:40:39 â”‚ INFO â”‚       â”œâ”€ Keto positive: 36,722 (16.3%)
08:40:39 â”‚ INFO â”‚       â”œâ”€ Vegan positive: 16,378 (7.3%)
08:40:39 â”‚ INFO â”‚       â”œâ”€ With photos: 225,602 (100.0%)
08:40:39 â”‚ INFO â”‚       â””â”€ Generation time: 102.7s
08:40:39 â”‚ INFO â”‚    âœ… Silver labels generated successfully in 102.8s
08:40:39 â”‚ INFO â”‚       ğŸ’¾ Silver labels generated: 17.1% memory used (4865 MB / 32015 MB)
08:40:39 â”‚ INFO â”‚ 
   âœ… STAGE 4: DATA VALIDATION AND CROSS-CHECKS
08:40:39 â”‚ INFO â”‚       ğŸ’¾ Memory Usage by Dataset:
08:40:39 â”‚ INFO â”‚       â”œâ”€ Recipes: 145.4 MB
08:40:39 â”‚ INFO â”‚       â”œâ”€ Silver: 106.4 MB
08:40:39 â”‚ INFO â”‚       â”œâ”€ Ground_truth: 0.1 MB
08:40:39 â”‚ INFO â”‚       â””â”€ Total: 251.9 MB
08:40:39 â”‚ INFO â”‚       ğŸ“Š Label Distribution Comparison:
08:40:39 â”‚ INFO â”‚       â”œâ”€ Keto: Gold=40.0%, Silver=16.3%
08:40:39 â”‚ INFO â”‚       â””â”€ Vegan: Gold=40.0%, Silver=7.3%
08:40:39 â”‚ WARNING â”‚       âš ï¸  Large keto distribution difference: 23.7%
08:40:39 â”‚ WARNING â”‚       âš ï¸  Large vegan distribution difference: 32.7%
08:40:39 â”‚ INFO â”‚       âœ… Validation Summary:
08:40:39 â”‚ INFO â”‚       â”œâ”€ Recipes Loaded: âœ…
08:40:39 â”‚ INFO â”‚       â”œâ”€ Ground Truth Loaded: âœ…
08:40:39 â”‚ INFO â”‚       â”œâ”€ Silver Generated: âœ…
08:40:39 â”‚ INFO â”‚       â”œâ”€ Required Columns Present: âœ…
08:40:39 â”‚ INFO â”‚       â”œâ”€ Labels Processed: âœ…
08:40:39 â”‚ INFO â”‚       â”œâ”€ Consistency Issues: 0
08:40:39 â”‚ INFO â”‚    âœ… Data validation completed in 0.6s
08:40:39 â”‚ INFO â”‚       ğŸ’¾ Validation complete: 17.2% memory used (4885 MB / 32015 MB)
08:40:39 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
08:40:39 â”‚ INFO â”‚    âœ… USDA table loaded in 0.1s â€“ 303 rows
08:40:40 â”‚ INFO â”‚ 
ğŸ DATASET LOADING COMPLETE
08:40:40 â”‚ INFO â”‚    â”œâ”€ Total loading time: 107.9s
08:40:40 â”‚ INFO â”‚    â”œâ”€ Datasets loaded: 4 (recipes, ground_truth, silver, usda)
08:40:40 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
08:40:40 â”‚ INFO â”‚    â””â”€ All validations passed: âœ…
08:40:40 â”‚ INFO â”‚ 
   ğŸ“‹ Final Dataset Summary:
08:40:40 â”‚ INFO â”‚    â”œâ”€ Recipes: 225,602 rows Ã— 5 columns
08:40:40 â”‚ INFO â”‚    â”œâ”€ Ground Truth: 100 rows Ã— 10 columns
08:40:40 â”‚ INFO â”‚    â”œâ”€ Silver Labels: 225,602 rows Ã— 5 columns
08:40:40 â”‚ INFO â”‚    â”œâ”€ USDA Carb Tbl:  303 rows Ã— 2 columns (0.0 MB)
08:40:40 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
08:40:40 â”‚ INFO â”‚    â””â”€ Ready for ML pipeline: âœ…
08:40:40 â”‚ INFO â”‚ 
   ğŸ“Š Dataset Statistics:
08:40:40 â”‚ INFO â”‚    â”œâ”€ Silver (All): 225,602 recipes
08:40:40 â”‚ INFO â”‚    â”œâ”€ Silver (Text): 225,602 recipes
08:40:40 â”‚ INFO â”‚    â”œâ”€ Silver (Images): 72,485 recipes
08:40:40 â”‚ INFO â”‚    â”œâ”€ Gold (All): 100 recipes
08:40:40 â”‚ INFO â”‚    â””â”€ Gold (Images): 66 recipes
08:40:40 â”‚ INFO â”‚ 
   âš–ï¸  Class Balance Analysis:
08:40:40 â”‚ INFO â”‚ 
â”€â”€ Gold set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
08:40:40 â”‚ INFO â”‚  keto:     40/100 (40.0%)
08:40:40 â”‚ INFO â”‚ vegan:     40/100 (40.0%)
08:40:40 â”‚ INFO â”‚ 
â”€â”€ Silver (Text) set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
08:40:40 â”‚ INFO â”‚  keto:  36722/225602 (16.3%)
08:40:40 â”‚ INFO â”‚ vegan:  16378/225602 ( 7.3%)
08:40:40 â”‚ INFO â”‚ 
â”€â”€ Silver (Image) set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
08:40:40 â”‚ INFO â”‚  keto:  28518/72485 (39.3%)
08:40:40 â”‚ INFO â”‚ vegan:  12577/72485 (17.4%)
08:40:40 â”‚ INFO â”‚    âœ… Data loading completed in 108.9s
08:40:40 â”‚ INFO â”‚    ğŸ“Š Data Loading - Memory: 17.3% used (4919 MB / 32015 MB)
08:40:40 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
08:40:40 â”‚ INFO â”‚ Safe memory limit (100%): 31.3 GB
08:40:40 â”‚ INFO â”‚    ğŸ§¹ Data Loading: Memory optimization
08:40:41 â”‚ INFO â”‚       â”œâ”€ Container/System memory: 31.3 GB total
08:40:41 â”‚ INFO â”‚       â”œâ”€ Currently used: 17.3% (4919 MB)
08:40:41 â”‚ INFO â”‚       âœ… Memory usage normal: 17.3%
08:40:41 â”‚ INFO â”‚ 
ğŸ”¤ STAGE 2: TEXT FEATURE PROCESSING
08:40:41 â”‚ INFO â”‚    â”œâ”€ Vectorizer config: {'min_df': 2, 'ngram_range': (1, 3), 'max_features': 50000, 'sublinear_tf': True}
08:40:41 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
08:40:41 â”‚ INFO â”‚    â”œâ”€ USDA examples added: 303
08:40:54 â”‚ INFO â”‚    ğŸ“Š Text Processing Results:
08:40:54 â”‚ INFO â”‚    â”œâ”€ Vocabulary size: 50,000
08:40:54 â”‚ INFO â”‚    â”œâ”€ Silver features: (225905, 50000)
08:40:54 â”‚ INFO â”‚    â”œâ”€ Gold features: (100, 50000)
08:40:54 â”‚ INFO â”‚    â”œâ”€ Sparsity: 0.0%
08:40:54 â”‚ INFO â”‚    â””â”€ Memory usage: ~103 MB
08:40:54 â”‚ INFO â”‚    âœ… Text processing completed in 13.4s
08:40:54 â”‚ INFO â”‚    ğŸ“Š Text Processing - Memory: 18.0% used (5136 MB / 32015 MB)
08:40:54 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
08:40:54 â”‚ INFO â”‚ Safe memory limit (100%): 31.3 GB
08:40:54 â”‚ INFO â”‚    ğŸ§¹ Text Processing: Memory optimization
08:40:54 â”‚ INFO â”‚       â”œâ”€ Container/System memory: 31.3 GB total
08:40:54 â”‚ INFO â”‚       â”œâ”€ Currently used: 18.0% (5137 MB)
08:40:55 â”‚ INFO â”‚       âœ… Memory usage normal: 18.3%
08:40:55 â”‚ INFO â”‚ 
ğŸ–¼ï¸  STAGE 3: IMAGE FEATURE PROCESSING
08:40:55 â”‚ INFO â”‚    â”œâ”€ Processing 72,485 sampled silver images
08:40:55 â”‚ INFO â”‚    â””â”€ Processing 66 gold images
08:40:55 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: silver
08:40:55 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/silver
08:40:55 â”‚ INFO â”‚    Total samples: 72,485
08:40:55 â”‚ INFO â”‚    Force recompute: False
08:40:55 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
08:40:55 â”‚ INFO â”‚    âŒ No suitable embeddings found - proceeding with downloads
08:40:55 â”‚ INFO â”‚ 
   ğŸ“‹ DOWNLOAD PLANNING:
08:40:57 â”‚ INFO â”‚       ğŸ“Š Analysis Results:
08:40:57 â”‚ INFO â”‚       â”œâ”€ Total samples: 72,485
08:40:57 â”‚ INFO â”‚       â”œâ”€ Existing valid files: 0
08:40:57 â”‚ INFO â”‚       â”œâ”€ Corrupted files cleaned: 0
08:40:57 â”‚ INFO â”‚       â”œâ”€ Valid URLs to download: 72,485
08:40:57 â”‚ INFO â”‚       â”œâ”€ Missing URLs: 0
08:40:57 â”‚ INFO â”‚       â””â”€ Invalid URLs: 0
08:40:57 â”‚ WARNING â”‚    âš ï¸  Large download required: 72,485 files
08:40:57 â”‚ INFO â”‚       â””â”€ This may take a while...
08:40:57 â”‚ INFO â”‚    ğŸ¯ Download Queue: 72,485 files
08:40:57 â”‚ INFO â”‚ 
   ğŸš€ EXECUTING ROBUST DOWNLOADS:
