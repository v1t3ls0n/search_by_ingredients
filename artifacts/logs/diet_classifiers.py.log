
================================================================================
NEW RUN STARTED AT 2025-06-21 05:18:43
Process ID: 101
================================================================================
05:18:43 â”‚ INFO â”‚ Logging system initialized successfully
05:18:43 â”‚ INFO â”‚ ğŸš€ Starting main with args: Namespace(ground_truth=None, train=True, ingredients=None, mode='both', force=False, sample_frac=0.3)
05:18:43 â”‚ INFO â”‚ ğŸ§  SINGLE training run - sample_frac=0.3
05:18:43 â”‚ INFO â”‚ ğŸš€ STARTING FULL ML PIPELINE
05:18:43 â”‚ INFO â”‚    Mode: both
05:18:43 â”‚ INFO â”‚    Force recomputation: False
05:18:43 â”‚ INFO â”‚    Sample fraction: 0.3
05:18:43 â”‚ INFO â”‚    Start time: 2025-06-21 05:18:43
05:18:43 â”‚ INFO â”‚    Available CPU cores: 24
05:18:43 â”‚ INFO â”‚    Available memory: 31 GB
05:18:43 â”‚ INFO â”‚ 
ğŸ“‚ STAGE 1: DATA LOADING AND PREPARATION
05:18:43 â”‚ INFO â”‚ 
ğŸ“‚ DATASET LOADING PIPELINE
05:18:43 â”‚ INFO â”‚    Configuration: 2 data sources
05:18:43 â”‚ INFO â”‚    Data directory: /app/data
05:18:43 â”‚ INFO â”‚    ğŸ“Š Data Sources:
05:18:43 â”‚ INFO â”‚    â”œâ”€ allrecipes.parquet: Local
05:18:43 â”‚ INFO â”‚    â”‚  â””â”€ /app/data/allrecipes.parquet
05:18:43 â”‚ INFO â”‚    â”œâ”€ ground_truth_sample.csv: Local
05:18:43 â”‚ INFO â”‚    â”‚  â””â”€ /app/data/ground_truth_sample.csv
05:18:43 â”‚ INFO â”‚ 
   ğŸ³ STAGE 1: LOADING RECIPES DATASET
05:18:43 â”‚ INFO â”‚    â”œâ”€ Source: /app/data/allrecipes.parquet
05:18:43 â”‚ INFO â”‚       â”œâ”€ Local file size: 49.2 MB
05:18:44 â”‚ INFO â”‚       ğŸ“Š Recipes Dataset:
05:18:44 â”‚ INFO â”‚       â”œâ”€ Shape: (225602, 5)
05:18:44 â”‚ INFO â”‚       â”œâ”€ Columns: ['title', 'description', 'instructions', 'ingredients', 'photo_url']
05:18:44 â”‚ INFO â”‚       â”œâ”€ Memory usage: 145.4 MB
05:18:44 â”‚ INFO â”‚       â””â”€ Load time: 0.4s
05:18:47 â”‚ INFO â”‚       ğŸ“ˆ Data Quality:
05:18:47 â”‚ INFO â”‚       â”œâ”€ Total recipes: 225,602
05:18:47 â”‚ INFO â”‚       â”œâ”€ Null ingredients: 0
05:18:47 â”‚ INFO â”‚       â”œâ”€ Empty ingredients: 0
05:18:47 â”‚ INFO â”‚       â””â”€ With photos: 225,602 (100.0%)
05:18:47 â”‚ INFO â”‚    âœ… Recipes loaded successfully in 3.9s
05:18:47 â”‚ INFO â”‚       ğŸ’¾ Recipes loaded: 13.6% memory used (3757 MB / 32015 MB)
05:18:47 â”‚ INFO â”‚ 
   ğŸ¯ STAGE 2: LOADING GROUND TRUTH DATASET
05:18:47 â”‚ INFO â”‚    â”œâ”€ Source: /app/data/ground_truth_sample.csv
05:18:47 â”‚ INFO â”‚       â”œâ”€ File size: 79.1 KB
05:18:47 â”‚ INFO â”‚       ğŸ“Š Ground Truth Dataset:
05:18:47 â”‚ INFO â”‚       â”œâ”€ Shape: (100, 7)
05:18:47 â”‚ INFO â”‚       â”œâ”€ Columns: ['title', 'description', 'instructions', 'ingredients', 'photo_url', 'vegan', 'keto']
05:18:47 â”‚ INFO â”‚       â”œâ”€ Keto columns found: ['keto']
05:18:47 â”‚ INFO â”‚       â”œâ”€ Vegan columns found: ['vegan']
05:18:47 â”‚ INFO â”‚       â””â”€ Load time: 0.00s
05:18:47 â”‚ INFO â”‚       â”œâ”€ Keto labels: 40/100 (40.0% positive)
05:18:47 â”‚ INFO â”‚       â”œâ”€ Vegan labels: 40/100 (40.0% positive)
05:18:49 â”‚ INFO â”‚    âœ… Ground truth loaded successfully in 1.8s
05:18:49 â”‚ INFO â”‚       ğŸ’¾ Ground truth loaded: 14.0% memory used (3867 MB / 32015 MB)
05:18:49 â”‚ INFO â”‚ 
   ğŸ¥ˆ STAGE 3: GENERATING SILVER LABELS

================================================================================
NEW RUN STARTED AT 2025-06-21 05:18:51
Process ID: 36
================================================================================
05:18:51 â”‚ INFO â”‚ Logging system initialized successfully

================================================================================
NEW RUN STARTED AT 2025-06-21 05:18:54
Process ID: 160
================================================================================
05:18:54 â”‚ INFO â”‚ Logging system initialized successfully
05:19:05 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
05:19:05 â”‚ INFO â”‚ Carb map initialised (303 keys)
05:20:30 â”‚ INFO â”‚       ğŸ“Š Silver Labels Generated:
05:20:30 â”‚ INFO â”‚       â”œâ”€ Total recipes: 225,602
05:20:30 â”‚ INFO â”‚       â”œâ”€ Keto positive: 36,722 (16.3%)
05:20:30 â”‚ INFO â”‚       â”œâ”€ Vegan positive: 16,378 (7.3%)
05:20:30 â”‚ INFO â”‚       â”œâ”€ With photos: 225,602 (100.0%)
05:20:30 â”‚ INFO â”‚       â””â”€ Generation time: 100.9s
05:20:30 â”‚ INFO â”‚    âœ… Silver labels generated successfully in 101.0s
05:20:30 â”‚ INFO â”‚       ğŸ’¾ Silver labels generated: 16.8% memory used (4780 MB / 32015 MB)
05:20:30 â”‚ INFO â”‚ 
   âœ… STAGE 4: DATA VALIDATION AND CROSS-CHECKS
05:20:30 â”‚ INFO â”‚       ğŸ’¾ Memory Usage by Dataset:
05:20:30 â”‚ INFO â”‚       â”œâ”€ Recipes: 145.4 MB
05:20:30 â”‚ INFO â”‚       â”œâ”€ Silver: 106.4 MB
05:20:30 â”‚ INFO â”‚       â”œâ”€ Ground_truth: 0.1 MB
05:20:30 â”‚ INFO â”‚       â””â”€ Total: 251.9 MB
05:20:30 â”‚ INFO â”‚       ğŸ“Š Label Distribution Comparison:
05:20:30 â”‚ INFO â”‚       â”œâ”€ Keto: Gold=40.0%, Silver=16.3%
05:20:30 â”‚ INFO â”‚       â””â”€ Vegan: Gold=40.0%, Silver=7.3%
05:20:30 â”‚ WARNING â”‚       âš ï¸  Large keto distribution difference: 23.7%
05:20:30 â”‚ WARNING â”‚       âš ï¸  Large vegan distribution difference: 32.7%
05:20:30 â”‚ INFO â”‚       âœ… Validation Summary:
05:20:30 â”‚ INFO â”‚       â”œâ”€ Recipes Loaded: âœ…
05:20:30 â”‚ INFO â”‚       â”œâ”€ Ground Truth Loaded: âœ…
05:20:31 â”‚ INFO â”‚       â”œâ”€ Silver Generated: âœ…
05:20:31 â”‚ INFO â”‚       â”œâ”€ Required Columns Present: âœ…
05:20:31 â”‚ INFO â”‚       â”œâ”€ Labels Processed: âœ…
05:20:31 â”‚ INFO â”‚       â”œâ”€ Consistency Issues: 0
05:20:31 â”‚ INFO â”‚    âœ… Data validation completed in 0.4s
05:20:31 â”‚ INFO â”‚       ğŸ’¾ Validation complete: 16.8% memory used (4788 MB / 32015 MB)
05:20:31 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
05:20:31 â”‚ INFO â”‚    âœ… USDA table loaded in 0.1s â€“ 303 rows
05:20:31 â”‚ INFO â”‚ 
ğŸ DATASET LOADING COMPLETE
05:20:31 â”‚ INFO â”‚    â”œâ”€ Total loading time: 107.5s
05:20:31 â”‚ INFO â”‚    â”œâ”€ Datasets loaded: 4 (recipes, ground_truth, silver, usda)
05:20:31 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
05:20:31 â”‚ INFO â”‚    â””â”€ All validations passed: âœ…
05:20:31 â”‚ INFO â”‚ 
   ğŸ“‹ Final Dataset Summary:
05:20:31 â”‚ INFO â”‚    â”œâ”€ Recipes: 225,602 rows Ã— 5 columns
05:20:31 â”‚ INFO â”‚    â”œâ”€ Ground Truth: 100 rows Ã— 10 columns
05:20:31 â”‚ INFO â”‚    â”œâ”€ Silver Labels: 225,602 rows Ã— 5 columns
05:20:31 â”‚ INFO â”‚    â”œâ”€ USDA Carb Tbl:  303 rows Ã— 2 columns (0.0 MB)
05:20:31 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
05:20:31 â”‚ INFO â”‚    â””â”€ Ready for ML pipeline: âœ…
05:20:31 â”‚ INFO â”‚    ğŸ“‰ Consistent sampling: Using 6,485 common indices
05:20:31 â”‚ INFO â”‚    ğŸ“‰ Applied sampling before processing:
05:20:31 â”‚ INFO â”‚    â”œâ”€ Text: 67,681 â†’ 20,304 rows (30.0%)
05:20:31 â”‚ INFO â”‚    â””â”€ Images: 21,734 â†’ 6,485 rows (30.0%)
05:20:31 â”‚ INFO â”‚ 
   ğŸ“Š Dataset Statistics:
05:20:31 â”‚ INFO â”‚    â”œâ”€ Silver (All): 67,681 recipes
05:20:31 â”‚ INFO â”‚    â”œâ”€ Silver (Text): 20,304 recipes
05:20:31 â”‚ INFO â”‚    â”œâ”€ Silver (Images): 6,485 recipes
05:20:31 â”‚ INFO â”‚    â”œâ”€ Gold (All): 100 recipes
05:20:31 â”‚ INFO â”‚    â””â”€ Gold (Images): 66 recipes
05:20:31 â”‚ INFO â”‚ 
   âš–ï¸  Class Balance Analysis:
05:20:31 â”‚ INFO â”‚ 
â”€â”€ Gold set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
05:20:31 â”‚ INFO â”‚  keto:     40/100 (40.0%)
05:20:31 â”‚ INFO â”‚ vegan:     40/100 (40.0%)
05:20:31 â”‚ INFO â”‚ 
â”€â”€ Silver (Text) set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
05:20:31 â”‚ INFO â”‚  keto:   3314/20304 (16.3%)
05:20:31 â”‚ INFO â”‚ vegan:   1444/20304 ( 7.1%)
05:20:31 â”‚ INFO â”‚ 
â”€â”€ Silver (Image) set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
05:20:31 â”‚ INFO â”‚  keto:   2574/6485 (39.7%)
05:20:31 â”‚ INFO â”‚ vegan:   1116/6485 (17.2%)
05:20:31 â”‚ INFO â”‚    âœ… Data loading completed in 108.1s
05:20:31 â”‚ INFO â”‚    ğŸ“Š Data Loading - Memory: 16.9% used (4804 MB / 32015 MB)
05:20:31 â”‚ INFO â”‚    ğŸ§¹ Data Loading: Memory cleanup
05:20:31 â”‚ INFO â”‚       â”œâ”€ RAM: 16.9% used (4804 MB)
05:20:31 â”‚ INFO â”‚       âœ… Memory usage normal: 16.9%
05:20:31 â”‚ INFO â”‚ 
ğŸ”¤ STAGE 2: TEXT FEATURE PROCESSING
05:20:31 â”‚ INFO â”‚    â”œâ”€ Vectorizer config: {'min_df': 2, 'ngram_range': (1, 3), 'max_features': 50000, 'sublinear_tf': True}
05:20:32 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
05:20:32 â”‚ INFO â”‚    â”œâ”€ USDA examples added: 303
05:20:33 â”‚ INFO â”‚    ğŸ“Š Text Processing Results:
05:20:33 â”‚ INFO â”‚    â”œâ”€ Vocabulary size: 40,682
05:20:33 â”‚ INFO â”‚    â”œâ”€ Silver features: (20607, 40682)
05:20:33 â”‚ INFO â”‚    â”œâ”€ Gold features: (100, 40682)
05:20:33 â”‚ INFO â”‚    â”œâ”€ Sparsity: 0.0%
05:20:33 â”‚ INFO â”‚    â””â”€ Memory usage: ~9 MB
05:20:33 â”‚ INFO â”‚    âœ… Text processing completed in 1.4s
05:20:33 â”‚ INFO â”‚    ğŸ“Š Text Processing - Memory: 16.9% used (4814 MB / 32015 MB)
05:20:33 â”‚ INFO â”‚    ğŸ§¹ Text Processing: Memory cleanup
05:20:33 â”‚ INFO â”‚       â”œâ”€ RAM: 16.9% used (4814 MB)
05:20:33 â”‚ INFO â”‚       âœ… Memory usage normal: 16.9%
05:20:33 â”‚ INFO â”‚ 
ğŸ–¼ï¸  STAGE 3: IMAGE FEATURE PROCESSING
05:20:33 â”‚ INFO â”‚    â”œâ”€ Processing 6,485 sampled silver images
05:20:33 â”‚ INFO â”‚    â””â”€ Processing 66 gold images
05:20:33 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: silver
05:20:33 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/silver
05:20:33 â”‚ INFO â”‚    Total samples: 6,485
05:20:33 â”‚ INFO â”‚    Force recompute: False
05:20:33 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
05:20:33 â”‚ INFO â”‚    âŒ No suitable embeddings found - proceeding with downloads
05:20:33 â”‚ INFO â”‚ 
   ğŸ“‹ DOWNLOAD PLANNING:
05:20:33 â”‚ INFO â”‚       ğŸ“Š Analysis Results:
05:20:33 â”‚ INFO â”‚       â”œâ”€ Total samples: 6,485
05:20:33 â”‚ INFO â”‚       â”œâ”€ Existing valid files: 0
05:20:33 â”‚ INFO â”‚       â”œâ”€ Corrupted files cleaned: 0
05:20:33 â”‚ INFO â”‚       â”œâ”€ Valid URLs to download: 6,485
05:20:33 â”‚ INFO â”‚       â”œâ”€ Missing URLs: 0
05:20:33 â”‚ INFO â”‚       â””â”€ Invalid URLs: 0
05:20:33 â”‚ WARNING â”‚    âš ï¸  Large download required: 6,485 files
05:20:33 â”‚ INFO â”‚       â””â”€ This may take a while...
05:20:33 â”‚ INFO â”‚    ğŸ¯ Download Queue: 6,485 files
05:20:33 â”‚ INFO â”‚ 
   ğŸš€ EXECUTING ROBUST DOWNLOADS:
05:26:01 â”‚ INFO â”‚ 
   ğŸ“Š DOWNLOAD RESULTS:
05:26:01 â”‚ INFO â”‚    â”œâ”€ Processing time: 328.0s
05:26:01 â”‚ INFO â”‚    â”œâ”€ Files downloaded: 6,255
05:26:01 â”‚ INFO â”‚    â”œâ”€ Files skipped: 0
05:26:01 â”‚ INFO â”‚    â”œâ”€ Download failures: 230
05:26:01 â”‚ INFO â”‚    â”œâ”€ Retry attempts: 0
05:26:01 â”‚ INFO â”‚    â””â”€ Data transferred: 189.9 MB
05:26:01 â”‚ INFO â”‚ 
   ğŸ“ˆ SUCCESS METRICS:
05:26:01 â”‚ INFO â”‚    â”œâ”€ Download success rate: 96.5%
05:26:01 â”‚ INFO â”‚    â”œâ”€ Total valid files: 6,255
05:26:01 â”‚ INFO â”‚    â”œâ”€ Coverage: 96.5% of dataset
05:26:01 â”‚ INFO â”‚    âœ… ACCEPTABLE COVERAGE - proceeding with 6,255 images
05:26:01 â”‚ INFO â”‚       â”œâ”€ Silver download: 6,255/6,485 successful
05:26:01 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: gold
05:26:01 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/gold
05:26:01 â”‚ INFO â”‚    Total samples: 66
05:26:01 â”‚ INFO â”‚    Force recompute: False
05:26:01 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
05:26:01 â”‚ INFO â”‚    âŒ No suitable embeddings found - proceeding with downloads
05:26:01 â”‚ INFO â”‚ 
   ğŸ“‹ DOWNLOAD PLANNING:
05:26:01 â”‚ INFO â”‚       ğŸ“Š Analysis Results:
05:26:01 â”‚ INFO â”‚       â”œâ”€ Total samples: 66
05:26:01 â”‚ INFO â”‚       â”œâ”€ Existing valid files: 0
05:26:01 â”‚ INFO â”‚       â”œâ”€ Corrupted files cleaned: 0
05:26:02 â”‚ INFO â”‚       â”œâ”€ Valid URLs to download: 66
05:26:02 â”‚ INFO â”‚       â”œâ”€ Missing URLs: 0
05:26:02 â”‚ INFO â”‚       â””â”€ Invalid URLs: 0
05:26:02 â”‚ WARNING â”‚    âš ï¸  Large download required: 66 files
05:26:02 â”‚ INFO â”‚       â””â”€ This may take a while...
05:26:02 â”‚ INFO â”‚    ğŸ¯ Download Queue: 66 files
05:26:02 â”‚ INFO â”‚ 
   ğŸš€ EXECUTING ROBUST DOWNLOADS:
05:26:04 â”‚ INFO â”‚ 
   ğŸ“Š DOWNLOAD RESULTS:
05:26:04 â”‚ INFO â”‚    â”œâ”€ Processing time: 2.4s
05:26:04 â”‚ INFO â”‚    â”œâ”€ Files downloaded: 66
05:26:04 â”‚ INFO â”‚    â”œâ”€ Files skipped: 0
05:26:04 â”‚ INFO â”‚    â”œâ”€ Download failures: 0
05:26:04 â”‚ INFO â”‚    â”œâ”€ Retry attempts: 0
05:26:04 â”‚ INFO â”‚    â””â”€ Data transferred: 2.1 MB
05:26:04 â”‚ INFO â”‚ 
   ğŸ“ˆ SUCCESS METRICS:
05:26:04 â”‚ INFO â”‚    â”œâ”€ Download success rate: 100.0%
05:26:04 â”‚ INFO â”‚    â”œâ”€ Total valid files: 66
05:26:04 â”‚ INFO â”‚    â”œâ”€ Coverage: 100.0% of dataset
05:26:04 â”‚ INFO â”‚    âœ… ACCEPTABLE COVERAGE - proceeding with 66 images
05:26:04 â”‚ INFO â”‚       â”œâ”€ Gold download: 66/66 successful
05:26:04 â”‚ INFO â”‚       â”œâ”€ Silver filtered: 6,255 with valid images
05:26:04 â”‚ INFO â”‚       â”œâ”€ Gold filtered: 66 with valid images
05:26:04 â”‚ INFO â”‚       â”œâ”€ Gold filtered: 66 with valid images
05:26:04 â”‚ INFO â”‚ 
ğŸ§  IMAGE EMBEDDING EXTRACTION: silver
05:26:04 â”‚ INFO â”‚    Target images: 6,255
05:26:04 â”‚ INFO â”‚    Mode: silver
05:26:04 â”‚ INFO â”‚    Force recomputation: False
05:26:04 â”‚ INFO â”‚    ğŸ”§ Device Configuration:
05:26:04 â”‚ INFO â”‚    â”œâ”€ Device: cpu
05:26:04 â”‚ INFO â”‚    â”œâ”€ CUDA available: False
05:26:04 â”‚ INFO â”‚    â””â”€ Using CPU (warning: much slower)
05:26:04 â”‚ INFO â”‚    ğŸ“ Paths:
05:26:04 â”‚ INFO â”‚    â”œâ”€ Image directory: dataset/arg_max/images/silver
05:26:04 â”‚ INFO â”‚    â”œâ”€ Cache file: dataset/arg_max/images/silver/embeddings.npy
05:26:04 â”‚ INFO â”‚    â””â”€ Backup file: /app/artifacts/embeddings_silver_backup.npy
05:26:04 â”‚ INFO â”‚ 
   ğŸ” Cache Validation:
05:26:04 â”‚ INFO â”‚       â”œâ”€ Artifacts backup: Not found
05:26:04 â”‚ INFO â”‚       â”œâ”€ Primary cache: Not found
05:26:04 â”‚ INFO â”‚       â”œâ”€ Legacy backup: Not found
05:26:04 â”‚ INFO â”‚       â””â”€ No valid cache found - will compute embeddings
05:26:04 â”‚ INFO â”‚ 
   ğŸ“Š Pre-processing Analysis:
05:26:05 â”‚ INFO â”‚       ğŸ“ˆ Image Availability:
05:26:05 â”‚ INFO â”‚       â”œâ”€ Total expected: 6,255
05:26:05 â”‚ INFO â”‚       â”œâ”€ Available: 6,255 (100.0%)
05:26:05 â”‚ INFO â”‚       â”œâ”€ Missing: 0 (0.0%)
05:26:05 â”‚ INFO â”‚       â””â”€ Corrupted: 0 (0.0%)
05:26:05 â”‚ INFO â”‚       ğŸ“Š Sample Analysis (10 images):
05:26:05 â”‚ INFO â”‚       â”œâ”€ Average size: 467Ã—296 pixels
05:26:05 â”‚ INFO â”‚       â”œâ”€ Average file size: 35.1 KB
05:26:05 â”‚ INFO â”‚       â”œâ”€ Color modes: {'RGB': 10}
05:26:05 â”‚ INFO â”‚       â””â”€ Formats: {'JPEG': 10}
05:26:05 â”‚ INFO â”‚ 
   ğŸ¤– Model Setup:
05:27:17 â”‚ INFO â”‚       âœ… Model loaded in 72.54s
05:27:17 â”‚ INFO â”‚       â”œâ”€ Architecture: ResNet-50 (feature extractor)
05:27:17 â”‚ INFO â”‚       â”œâ”€ Output dimension: 2048
05:27:17 â”‚ INFO â”‚       â”œâ”€ Device: cpu
05:27:17 â”‚ INFO â”‚       â””â”€ Parameters: 23,508,032
05:27:17 â”‚ INFO â”‚ 
   âš¡ Feature Extraction:
05:27:17 â”‚ INFO â”‚       ğŸ”§ Processing Configuration:
05:27:17 â”‚ INFO â”‚       â”œâ”€ Batch size: 8
05:27:17 â”‚ INFO â”‚       â”œâ”€ Total batches: 782
05:27:17 â”‚ INFO â”‚       â””â”€ Expected output shape: (6255, 2048)
05:27:42 â”‚ INFO â”‚    ğŸ§¹ Batch Processing: Memory cleanup
05:27:42 â”‚ INFO â”‚       â”œâ”€ RAM: 17.6% used (5006 MB)
05:27:42 â”‚ INFO â”‚       âœ… Memory usage normal: 17.6%
05:28:07 â”‚ INFO â”‚    ğŸ§¹ Batch Processing: Memory cleanup
05:28:07 â”‚ INFO â”‚       â”œâ”€ RAM: 19.0% used (5466 MB)
05:28:07 â”‚ INFO â”‚       âœ… Memory usage normal: 19.0%
05:28:32 â”‚ INFO â”‚    ğŸ§¹ Batch Processing: Memory cleanup
05:28:32 â”‚ INFO â”‚       â”œâ”€ RAM: 19.3% used (5562 MB)
05:28:32 â”‚ INFO â”‚       âœ… Memory usage normal: 19.3%
05:28:58 â”‚ INFO â”‚    ğŸ§¹ Batch Processing: Memory cleanup
05:28:58 â”‚ INFO â”‚       â”œâ”€ RAM: 19.8% used (5723 MB)
05:28:58 â”‚ INFO â”‚       âœ… Memory usage normal: 19.8%
05:29:25 â”‚ INFO â”‚    ğŸ§¹ Batch Processing: Memory cleanup
05:29:25 â”‚ INFO â”‚       â”œâ”€ RAM: 20.5% used (5941 MB)
05:29:25 â”‚ INFO â”‚       âœ… Memory usage normal: 20.5%
05:29:52 â”‚ INFO â”‚    ğŸ§¹ Batch Processing: Memory cleanup
05:29:52 â”‚ INFO â”‚       â”œâ”€ RAM: 20.8% used (6052 MB)
05:29:52 â”‚ INFO â”‚       âœ… Memory usage normal: 20.8%
05:29:59 â”‚ INFO â”‚ 
   ğŸ“Š Extraction Results:
05:30:00 â”‚ INFO â”‚    â”œâ”€ Total processing time: 235.4s
05:30:00 â”‚ INFO â”‚    â”œâ”€ Successfully processed: 6,255
05:30:00 â”‚ INFO â”‚    â”œâ”€ Missing images: 0
05:30:00 â”‚ INFO â”‚    â”œâ”€ Failed processing: 0
05:30:00 â”‚ INFO â”‚    â””â”€ Overall success rate: 100.0%
05:30:00 â”‚ INFO â”‚    âš¡ Performance Metrics:
05:30:00 â”‚ INFO â”‚    â”œâ”€ Average processing time: 0.026s per image
05:30:00 â”‚ INFO â”‚    â”œâ”€ Throughput: 26.6 images/second
05:30:00 â”‚ INFO â”‚    â””â”€ Device efficiency: cpu
05:30:00 â”‚ INFO â”‚ 
   ğŸ’¾ Saving Results:
05:30:00 â”‚ INFO â”‚    ğŸ’¾ Metadata saved to: dataset/arg_max/images/silver/embedding_metadata.json
05:30:00 â”‚ INFO â”‚    ğŸ“Š File Information:
05:30:00 â”‚ INFO â”‚    â”œâ”€ Primary cache: 48.9 MB (dataset/arg_max/images/silver/embeddings.npy)
05:30:00 â”‚ INFO â”‚    â”œâ”€ Backup cache: 48.9 MB (/app/artifacts/embeddings_silver_backup.npy)
05:30:00 â”‚ INFO â”‚    â””â”€ Array shape: (6255, 2048)
05:30:00 â”‚ INFO â”‚ 
   ğŸ EMBEDDING EXTRACTION COMPLETE:
05:30:00 â”‚ INFO â”‚    â”œâ”€ Output shape: (6255, 2048)
05:30:00 â”‚ INFO â”‚    â”œâ”€ Success rate: 100.0%
05:30:00 â”‚ INFO â”‚    â”œâ”€ Total time: 235.4s
05:30:00 â”‚ INFO â”‚    â”œâ”€ Throughput: 26.6 images/s
05:30:00 â”‚ INFO â”‚    â””â”€ Files saved: Primary + Backup + Metadata
05:30:00 â”‚ INFO â”‚       â”œâ”€ Quality filtering: 5003/6255 images kept
05:30:00 â”‚ INFO â”‚    ğŸ“Š Quality filtering reduced images from 6255 to 5003
05:30:00 â”‚ INFO â”‚       â”œâ”€ Aligning silver DataFrame: 6,255 â†’ 5,003 rows
05:30:00 â”‚ INFO â”‚       â”œâ”€ Silver embeddings: (5003, 2048)
05:30:00 â”‚ INFO â”‚       â”œâ”€ Silver DataFrame: 5,003 rows
05:30:00 â”‚ INFO â”‚ 
ğŸ§  IMAGE EMBEDDING EXTRACTION: gold
05:30:00 â”‚ INFO â”‚    Target images: 66
05:30:00 â”‚ INFO â”‚    Mode: gold
05:30:00 â”‚ INFO â”‚    Force recomputation: False
05:30:00 â”‚ INFO â”‚    ğŸ”§ Device Configuration:
05:30:00 â”‚ INFO â”‚    â”œâ”€ Device: cpu
05:30:00 â”‚ INFO â”‚    â”œâ”€ CUDA available: False
05:30:00 â”‚ INFO â”‚    â””â”€ Using CPU (warning: much slower)
05:30:00 â”‚ INFO â”‚    ğŸ“ Paths:
05:30:00 â”‚ INFO â”‚    â”œâ”€ Image directory: dataset/arg_max/images/gold
05:30:00 â”‚ INFO â”‚    â”œâ”€ Cache file: dataset/arg_max/images/gold/embeddings.npy
05:30:00 â”‚ INFO â”‚    â””â”€ Backup file: /app/artifacts/embeddings_gold_backup.npy
05:30:00 â”‚ INFO â”‚ 
   ğŸ” Cache Validation:
05:30:00 â”‚ INFO â”‚       â”œâ”€ Artifacts backup: Not found
05:30:00 â”‚ INFO â”‚       â”œâ”€ Primary cache: Not found
05:30:00 â”‚ INFO â”‚       â”œâ”€ Legacy backup: Not found
05:30:00 â”‚ INFO â”‚       â””â”€ No valid cache found - will compute embeddings
05:30:00 â”‚ INFO â”‚ 
   ğŸ“Š Pre-processing Analysis:
05:30:00 â”‚ INFO â”‚       ğŸ“ˆ Image Availability:
05:30:00 â”‚ INFO â”‚       â”œâ”€ Total expected: 66
05:30:00 â”‚ INFO â”‚       â”œâ”€ Available: 66 (100.0%)
05:30:00 â”‚ INFO â”‚       â”œâ”€ Missing: 0 (0.0%)
05:30:00 â”‚ INFO â”‚       â””â”€ Corrupted: 0 (0.0%)
05:30:00 â”‚ INFO â”‚       ğŸ“Š Sample Analysis (10 images):
05:30:00 â”‚ INFO â”‚       â”œâ”€ Average size: 436Ã—289 pixels
05:30:00 â”‚ INFO â”‚       â”œâ”€ Average file size: 32.7 KB
05:30:00 â”‚ INFO â”‚       â”œâ”€ Color modes: {'RGB': 10}
05:30:00 â”‚ INFO â”‚       â””â”€ Formats: {'JPEG': 10}
05:30:01 â”‚ INFO â”‚ 
   ğŸ¤– Model Setup:
05:30:01 â”‚ INFO â”‚       âœ… Model loaded in 0.17s
05:30:01 â”‚ INFO â”‚       â”œâ”€ Architecture: ResNet-50 (feature extractor)
05:30:01 â”‚ INFO â”‚       â”œâ”€ Output dimension: 2048
05:30:01 â”‚ INFO â”‚       â”œâ”€ Device: cpu
05:30:01 â”‚ INFO â”‚       â””â”€ Parameters: 23,508,032
05:30:01 â”‚ INFO â”‚ 
   âš¡ Feature Extraction:
05:30:01 â”‚ INFO â”‚       ğŸ”§ Processing Configuration:
05:30:01 â”‚ INFO â”‚       â”œâ”€ Batch size: 8
05:30:01 â”‚ INFO â”‚       â”œâ”€ Total batches: 9
05:30:01 â”‚ INFO â”‚       â””â”€ Expected output shape: (66, 2048)
05:30:03 â”‚ INFO â”‚ 
   ğŸ“Š Extraction Results:
05:30:03 â”‚ INFO â”‚    â”œâ”€ Total processing time: 2.4s
05:30:03 â”‚ INFO â”‚    â”œâ”€ Successfully processed: 66
05:30:03 â”‚ INFO â”‚    â”œâ”€ Missing images: 0
05:30:03 â”‚ INFO â”‚    â”œâ”€ Failed processing: 0
05:30:03 â”‚ INFO â”‚    â””â”€ Overall success rate: 100.0%
05:30:03 â”‚ INFO â”‚    âš¡ Performance Metrics:
05:30:03 â”‚ INFO â”‚    â”œâ”€ Average processing time: 0.026s per image
05:30:03 â”‚ INFO â”‚    â”œâ”€ Throughput: 27.9 images/second
05:30:03 â”‚ INFO â”‚    â””â”€ Device efficiency: cpu
05:30:03 â”‚ INFO â”‚ 
   ğŸ’¾ Saving Results:
05:30:03 â”‚ INFO â”‚    ğŸ’¾ Metadata saved to: dataset/arg_max/images/gold/embedding_metadata.json
05:30:03 â”‚ INFO â”‚    ğŸ“Š File Information:
05:30:03 â”‚ INFO â”‚    â”œâ”€ Primary cache: 0.5 MB (dataset/arg_max/images/gold/embeddings.npy)
05:30:03 â”‚ INFO â”‚    â”œâ”€ Backup cache: 0.5 MB (/app/artifacts/embeddings_gold_backup.npy)
05:30:03 â”‚ INFO â”‚    â””â”€ Array shape: (66, 2048)
05:30:03 â”‚ INFO â”‚ 
   ğŸ EMBEDDING EXTRACTION COMPLETE:
05:30:03 â”‚ INFO â”‚    â”œâ”€ Output shape: (66, 2048)
05:30:03 â”‚ INFO â”‚    â”œâ”€ Success rate: 100.0%
05:30:03 â”‚ INFO â”‚    â”œâ”€ Total time: 2.4s
05:30:03 â”‚ INFO â”‚    â”œâ”€ Throughput: 27.9 images/s
05:30:03 â”‚ INFO â”‚    â””â”€ Files saved: Primary + Backup + Metadata
05:30:03 â”‚ INFO â”‚       â”œâ”€ Quality filtering: 52/66 images kept
05:30:03 â”‚ INFO â”‚    ğŸ“Š Quality filtering reduced images from 66 to 52
05:30:03 â”‚ INFO â”‚       â”œâ”€ Aligning gold DataFrame: 66 â†’ 52 rows
05:30:03 â”‚ INFO â”‚       â”œâ”€ Gold embeddings: (52, 2048)
05:30:03 â”‚ INFO â”‚       â”œâ”€ Gold DataFrame: 52 rows
05:30:03 â”‚ INFO â”‚       â”œâ”€ Saved gold embeddings to embeddings/img_gold.pkl
05:30:03 â”‚ INFO â”‚       â”œâ”€ Saved silver embeddings to embeddings/img_silver.pkl
05:30:03 â”‚ INFO â”‚    ğŸ” DIMENSION VERIFICATION:
05:30:03 â”‚ INFO â”‚    â”œâ”€ Silver embeddings: (5003, 2048)
05:30:03 â”‚ INFO â”‚    â”œâ”€ Silver DataFrame: 5,003 rows
05:30:03 â”‚ INFO â”‚    â”œâ”€ Gold embeddings: (52, 2048)
05:30:03 â”‚ INFO â”‚    â””â”€ Gold DataFrame: 52 rows
05:30:03 â”‚ INFO â”‚    ğŸ“Š Image Processing Results:
05:30:03 â”‚ INFO â”‚    â”œâ”€ Silver images available: 6,485
05:30:03 â”‚ INFO â”‚    â”œâ”€ Silver images downloaded: 6,255
05:30:03 â”‚ INFO â”‚    â”œâ”€ Silver valid embeddings: 5,003
05:30:03 â”‚ INFO â”‚    â”œâ”€ Gold images available: 66
05:30:03 â”‚ INFO â”‚    â”œâ”€ Gold images downloaded: 66
05:30:03 â”‚ INFO â”‚    â”œâ”€ Gold valid embeddings: 52
05:30:03 â”‚ INFO â”‚    â”œâ”€ Silver embedding size: 39 MB
05:30:03 â”‚ INFO â”‚    â””â”€ Gold embedding size: 0 MB
05:30:03 â”‚ INFO â”‚    âœ… Image processing completed in 570.3s
05:30:03 â”‚ INFO â”‚    ğŸ“Š Image Processing - Memory: 21.3% used (6184 MB / 32015 MB)
05:30:03 â”‚ INFO â”‚    ğŸ§¹ Image Processing: Memory cleanup
05:30:03 â”‚ INFO â”‚       â”œâ”€ RAM: 21.3% used (6184 MB)
05:30:03 â”‚ INFO â”‚       âœ… Memory usage normal: 21.3%
05:30:03 â”‚ INFO â”‚ 
ğŸ¤– STAGE 4: MODEL TRAINING
05:30:03 â”‚ INFO â”‚    ğŸ–¼ï¸  Training image-based models...
05:30:03 â”‚ INFO â”‚ ğŸš€ Starting MODE A Training Pipeline
05:30:04 â”‚ INFO â”‚    Domain: image
05:30:04 â”‚ INFO â”‚    SMOTE enabled: False
05:30:04 â”‚ INFO â”‚    Silver set size: 5,003
05:30:04 â”‚ INFO â”‚    Gold set size: 52
05:30:04 â”‚ INFO â”‚    Feature dimensions: (5003, 2048)
05:30:04 â”‚ INFO â”‚ 
ğŸ“Š Class Distribution Analysis:
05:30:04 â”‚ INFO â”‚     Keto - Silver: 2,057/5,003 (41.1%) | Gold: 27/52 (51.9%)
05:30:04 â”‚ INFO â”‚    Vegan - Silver: 850/5,003 (17.0%) | Gold: 28/52 (53.8%)
05:30:04 â”‚ INFO â”‚ 
ğŸ¯ Processing KETO classification:
05:30:04 â”‚ INFO â”‚    Training labels - Positive: 2,057 (41.1%)
05:30:04 â”‚ INFO â”‚    Test labels - Positive: 27 (51.9%)
05:30:04 â”‚ INFO â”‚    â­ï¸  SMOTE disabled, using original data
05:30:04 â”‚ INFO â”‚    ğŸ¤– Training 3 models: ['MLP', 'RF', 'LGBM']
05:30:12 â”‚ INFO â”‚       âœ…    MLP_IMAGE: F1=0.400 | ACC=0.596 | PREC=0.875 | REC=0.259 | Time=8.0s
05:30:12 â”‚ INFO â”‚       ğŸ† New best model for keto: MLP_IMAGE (F1=0.400)
05:30:14 â”‚ INFO â”‚       âœ…     RF_IMAGE: F1=0.444 | ACC=0.615 | PREC=0.889 | REC=0.296 | Time=2.4s
05:30:14 â”‚ INFO â”‚       ğŸ† New best model for keto: RF_IMAGE (F1=0.444)
05:30:45 â”‚ INFO â”‚       âœ…   LGBM_IMAGE: F1=0.526 | ACC=0.654 | PREC=0.909 | REC=0.370 | Time=31.3s
05:30:45 â”‚ INFO â”‚       ğŸ† New best model for keto: LGBM_IMAGE (F1=0.526)
05:30:46 â”‚ INFO â”‚    ğŸ¯ KETO COMPLETE:
05:30:46 â”‚ INFO â”‚    â”œâ”€ Best Model: LGBM_IMAGE (F1=0.526)
05:30:46 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.654 | PREC=0.909 | REC=0.370
05:30:46 â”‚ INFO â”‚    â””â”€ Task Time: 41.9s
05:30:46 â”‚ INFO â”‚ 
ğŸ¯ Processing VEGAN classification:
05:30:46 â”‚ INFO â”‚    Training labels - Positive: 850 (17.0%)
05:30:46 â”‚ INFO â”‚    Test labels - Positive: 28 (53.8%)
05:30:46 â”‚ INFO â”‚    â­ï¸  SMOTE disabled, using original data
05:30:46 â”‚ INFO â”‚    ğŸ¤– Training 3 models: ['MLP', 'RF', 'LGBM']
05:30:56 â”‚ INFO â”‚       âœ…    MLP_IMAGE: F1=0.526 | ACC=0.654 | PREC=1.000 | REC=0.357 | Time=10.4s
05:30:56 â”‚ INFO â”‚       ğŸ† New best model for vegan: MLP_IMAGE (F1=0.526)

================================================================================
NEW RUN STARTED AT 2025-06-21 05:30:58
Process ID: 318
================================================================================
05:30:58 â”‚ INFO â”‚ Logging system initialized successfully
05:30:58 â”‚ INFO â”‚       âœ…     RF_IMAGE: F1=0.194 | ACC=0.519 | PREC=1.000 | REC=0.107 | Time=2.0s
05:31:16 â”‚ INFO â”‚       âœ…   LGBM_IMAGE: F1=0.444 | ACC=0.615 | PREC=1.000 | REC=0.286 | Time=18.1s
05:31:16 â”‚ INFO â”‚    ğŸ¯ VEGAN COMPLETE:
05:31:16 â”‚ INFO â”‚    â”œâ”€ Best Model: MLP_IMAGE (F1=0.526)
05:31:16 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.654 | PREC=1.000 | REC=0.357
05:31:16 â”‚ INFO â”‚    â””â”€ Task Time: 30.6s
05:31:16 â”‚ INFO â”‚ 
ğŸ MODE A PIPELINE COMPLETE:
05:31:16 â”‚ INFO â”‚    â”œâ”€ Total Time: 72.7s
05:31:16 â”‚ INFO â”‚    â”œâ”€ Tasks Completed: 2
05:31:16 â”‚ INFO â”‚    â””â”€ Domain: image
05:31:16 â”‚ INFO â”‚ 
ğŸ“Š FINAL RESULTS SUMMARY:
05:31:16 â”‚ INFO â”‚    1.  KETO |      LGBM_IMAGE | F1=0.526 | ACC=0.654 | Time=31.3s
05:31:16 â”‚ INFO â”‚    2. VEGAN |       MLP_IMAGE | F1=0.526 | ACC=0.654 | Time=10.4s
05:31:16 â”‚ INFO â”‚ 
â•­â”€ MODE A (silver â†’ gold) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
05:31:16 â”‚ INFO â”‚ â”‚ model task     ACC    PREC     REC      F1     ROC      PR â”‚
05:31:16 â”‚ INFO â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
05:31:16 â”‚ INFO â”‚ â”‚ LGBM_IMAGE keto     0.65    0.91    0.37    0.53    0.90    0.89 â”‚
05:31:16 â”‚ INFO â”‚ â”‚ MLP_IMAGE vegan    0.65    1.00    0.36    0.53    1.00    1.00 â”‚
05:31:16 â”‚ INFO â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
05:31:16 â”‚ INFO â”‚       âœ… Image models: 2 results
05:31:17 â”‚ INFO â”‚    ğŸ§¹ Image Models: Memory cleanup
05:31:17 â”‚ INFO â”‚       â”œâ”€ RAM: 23.2% used (6801 MB)
05:31:17 â”‚ INFO â”‚       â”œâ”€ Objects collected: 23
05:31:17 â”‚ INFO â”‚       âœ… Memory usage normal: 23.2%
05:31:17 â”‚ INFO â”‚    ğŸ”¤ Training text-based models...
05:31:17 â”‚ INFO â”‚ ğŸš€ Starting MODE A Training Pipeline
05:31:17 â”‚ INFO â”‚    Domain: text
05:31:17 â”‚ INFO â”‚    SMOTE enabled: True
05:31:17 â”‚ INFO â”‚    Silver set size: 20,607
05:31:17 â”‚ INFO â”‚    Gold set size: 100
05:31:17 â”‚ INFO â”‚    Feature dimensions: (20607, 40682)
05:31:17 â”‚ INFO â”‚ 
ğŸ“Š Class Distribution Analysis:
05:31:17 â”‚ INFO â”‚     Keto - Silver: 3,477/20,607 (16.9%) | Gold: 40/100 (40.0%)
05:31:17 â”‚ INFO â”‚    Vegan - Silver: 1,444.0/20,607 (7.0%) | Gold: 40/100 (40.0%)
05:31:17 â”‚ INFO â”‚ 
ğŸ¯ Processing KETO classification:
05:31:17 â”‚ INFO â”‚    Training labels - Positive: 3,477 (16.9%)
05:31:17 â”‚ INFO â”‚    Test labels - Positive: 40 (40.0%)
05:31:17 â”‚ INFO â”‚    Minority class ratio: 16.9%
05:31:17 â”‚ INFO â”‚    ğŸ”„ Applying SMOTE (minority < 30%)...
05:31:17 â”‚ INFO â”‚    âœ… SMOTE completed in 0.0s
05:31:17 â”‚ INFO â”‚    â”œâ”€ Size: 20,607 â†’ 34,260 (1.7x)
05:31:17 â”‚ INFO â”‚    â””â”€ Minority ratio: 16.9% â†’ 50.0%
05:31:17 â”‚ INFO â”‚    ğŸ¤– Training 6 models: ['Rule', 'NB', 'Softmax', 'Ridge', 'PA', 'SGD']
05:31:17 â”‚ ERROR â”‚       âŒ Rule: Prediction failed - sparse array length is ambiguous; use ge...
05:31:17 â”‚ INFO â”‚       âœ…      NB_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=0.0s
05:31:17 â”‚ INFO â”‚       ğŸ† New best model for keto: NB_TEXT (F1=0.963)
05:31:18 â”‚ INFO â”‚       âœ… Softmax_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=1.1s
05:31:19 â”‚ INFO â”‚ Adding probability calibration to RidgeClassifier
05:31:22 â”‚ INFO â”‚       âœ…   Ridge_TEXT: F1=0.833 | ACC=0.880 | PREC=0.938 | REC=0.750 | Time=4.3s
05:31:22 â”‚ INFO â”‚ Adding probability calibration to PassiveAggressiveClassifier
05:31:24 â”‚ INFO â”‚       âœ…      PA_TEXT: F1=0.794 | ACC=0.860 | PREC=0.964 | REC=0.675 | Time=2.2s
05:31:25 â”‚ INFO â”‚       âœ…     SGD_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=0.1s
05:31:25 â”‚ INFO â”‚    ğŸ¯ KETO COMPLETE:
05:31:25 â”‚ INFO â”‚    â”œâ”€ Best Model: NB_TEXT (F1=0.963)
05:31:25 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.970 | PREC=0.951 | REC=0.975
05:31:25 â”‚ INFO â”‚    â””â”€ Task Time: 8.0s
05:31:25 â”‚ WARNING â”‚ Found 303 NaN values in vegan labels, filling with defaults
05:31:25 â”‚ INFO â”‚ 
ğŸ¯ Processing VEGAN classification:
05:31:25 â”‚ INFO â”‚    Training labels - Positive: 1,747 (8.5%)
05:31:25 â”‚ INFO â”‚    Test labels - Positive: 40 (40.0%)
05:31:25 â”‚ INFO â”‚    Minority class ratio: 8.5%
05:31:25 â”‚ INFO â”‚    ğŸ”„ Applying SMOTE (minority < 30%)...
05:31:25 â”‚ INFO â”‚    âœ… SMOTE completed in 0.0s
05:31:25 â”‚ INFO â”‚    â”œâ”€ Size: 20,607 â†’ 37,720 (1.8x)
05:31:25 â”‚ INFO â”‚    â””â”€ Minority ratio: 8.5% â†’ 50.0%
05:31:25 â”‚ INFO â”‚    ğŸ¤– Training 6 models: ['Rule', 'NB', 'Softmax', 'Ridge', 'PA', 'SGD']
05:31:25 â”‚ ERROR â”‚       âŒ Rule: Prediction failed - sparse array length is ambiguous; use ge...
05:31:25 â”‚ INFO â”‚       âœ…      NB_TEXT: F1=0.975 | ACC=0.980 | PREC=0.975 | REC=0.975 | Time=0.0s
05:31:25 â”‚ INFO â”‚       ğŸ† New best model for vegan: NB_TEXT (F1=0.975)
05:31:26 â”‚ INFO â”‚       âœ… Softmax_TEXT: F1=0.962 | ACC=0.970 | PREC=0.974 | REC=0.950 | Time=0.8s
05:31:26 â”‚ INFO â”‚ Adding probability calibration to RidgeClassifier
05:31:31 â”‚ INFO â”‚       âœ…   Ridge_TEXT: F1=0.738 | ACC=0.830 | PREC=0.960 | REC=0.600 | Time=5.6s
05:31:31 â”‚ INFO â”‚ Adding probability calibration to PassiveAggressiveClassifier
05:31:34 â”‚ INFO â”‚       âœ…      PA_TEXT: F1=0.667 | ACC=0.800 | PREC=1.000 | REC=0.500 | Time=2.6s
05:31:34 â”‚ INFO â”‚       âœ…     SGD_TEXT: F1=0.962 | ACC=0.970 | PREC=0.974 | REC=0.950 | Time=0.1s
05:31:34 â”‚ INFO â”‚    ğŸ¯ VEGAN COMPLETE:
05:31:34 â”‚ INFO â”‚    â”œâ”€ Best Model: NB_TEXT (F1=0.975)
05:31:34 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.980 | PREC=0.975 | REC=0.975
05:31:34 â”‚ INFO â”‚    â””â”€ Task Time: 9.4s
05:31:34 â”‚ INFO â”‚ 
ğŸ MODE A PIPELINE COMPLETE:
05:31:34 â”‚ INFO â”‚    â”œâ”€ Total Time: 17.6s
05:31:34 â”‚ INFO â”‚    â”œâ”€ Tasks Completed: 2
05:31:34 â”‚ INFO â”‚    â””â”€ Domain: text
05:31:34 â”‚ INFO â”‚ 
ğŸ“Š FINAL RESULTS SUMMARY:
05:31:34 â”‚ INFO â”‚    1.  KETO |         NB_TEXT | F1=0.963 | ACC=0.970 | Time=0.0s
05:31:34 â”‚ INFO â”‚    2. VEGAN |         NB_TEXT | F1=0.975 | ACC=0.980 | Time=0.0s
05:31:34 â”‚ INFO â”‚ 
â•­â”€ MODE A (silver â†’ gold) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
05:31:34 â”‚ INFO â”‚ â”‚ model task     ACC    PREC     REC      F1     ROC      PR â”‚
05:31:34 â”‚ INFO â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
05:31:34 â”‚ INFO â”‚ â”‚ NB_TEXT keto     0.97    0.95    0.97    0.96    0.97    0.94 â”‚
05:31:34 â”‚ INFO â”‚ â”‚ NB_TEXT vegan    0.98    0.97    0.97    0.97    0.97    0.92 â”‚
05:31:34 â”‚ INFO â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
05:31:34 â”‚ INFO â”‚       âœ… Text models: 2 results

================================================================================
05:31:34 â”‚ INFO â”‚    ğŸ§¹ Text Models: Memory cleanup
NEW RUN STARTED AT 2025-06-21 05:31:34
05:31:34 â”‚ INFO â”‚       â”œâ”€ RAM: 25.6% used (7585 MB)
Process ID: 474
05:31:34 â”‚ INFO â”‚       â”œâ”€ Objects collected: 96
================================================================================
05:31:35 â”‚ INFO â”‚       âœ… Memory usage normal: 25.6%
05:31:35 â”‚ INFO â”‚ Logging system initialized successfully
05:31:35 â”‚ INFO â”‚    ğŸ¤ Creating text+image ensemble...
05:31:35 â”‚ INFO â”‚       â”œâ”€ keto: Testing alpha values [0.25, 0.5, 0.75]
05:31:35 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (keto) â€” text=NB_TEXT (F1=0.963), image=LGBM_IMAGE
05:31:35 â”‚ ERROR â”‚       âŒ keto ensemble creation failed: Length of values (100) does not match length of in...
05:31:35 â”‚ INFO â”‚       â”œâ”€ vegan: Testing alpha values [0.25, 0.5, 0.75]
05:31:35 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (vegan) â€” text=NB_TEXT (F1=0.975), image=MLP_IMAGE
05:31:35 â”‚ ERROR â”‚       âŒ vegan ensemble creation failed: Length of values (100) does not match length of in...
05:31:35 â”‚ WARNING â”‚       âš ï¸  No successful ensembles created
05:31:35 â”‚ INFO â”‚    ğŸ”„ Training final combined models...
05:31:35 â”‚ INFO â”‚       â”œâ”€ Combined silver features: (1168, 42730)
05:31:35 â”‚ INFO â”‚       â”œâ”€ Combined gold features: (52, 42730)
05:31:35 â”‚ INFO â”‚       â”œâ”€ Silver samples: 1,168
05:31:35 â”‚ INFO â”‚       â””â”€ Gold samples: 52
05:31:35 â”‚ INFO â”‚ ğŸš€ Starting MODE A Training Pipeline
05:31:35 â”‚ INFO â”‚    Domain: both
05:31:35 â”‚ INFO â”‚    SMOTE enabled: True
05:31:35 â”‚ INFO â”‚    Silver set size: 1,168
05:31:35 â”‚ INFO â”‚    Gold set size: 52
05:31:35 â”‚ INFO â”‚    Feature dimensions: (1168, 42730)
05:31:35 â”‚ INFO â”‚ 
ğŸ“Š Class Distribution Analysis:
05:31:35 â”‚ INFO â”‚     Keto - Silver: 213/1,168 (18.2%) | Gold: 27/52 (51.9%)
05:31:35 â”‚ INFO â”‚    Vegan - Silver: 90.0/1,168 (7.7%) | Gold: 28/52 (53.8%)
05:31:35 â”‚ INFO â”‚ 
ğŸ¯ Processing KETO classification:
05:31:35 â”‚ INFO â”‚    Training labels - Positive: 213 (18.2%)
05:31:35 â”‚ INFO â”‚    Test labels - Positive: 27 (51.9%)
05:31:35 â”‚ INFO â”‚    Minority class ratio: 18.2%
05:31:35 â”‚ INFO â”‚    ğŸ”„ Applying SMOTE (minority < 30%)...
05:31:35 â”‚ INFO â”‚    âœ… SMOTE completed in 0.4s
05:31:35 â”‚ INFO â”‚    â”œâ”€ Size: 1,168 â†’ 1,241 (1.1x)
05:31:35 â”‚ INFO â”‚    â””â”€ Minority ratio: 18.2% â†’ 23.0%
05:31:35 â”‚ INFO â”‚    ğŸ¤– Training 9 models: ['Rule', 'NB', 'Softmax', 'Ridge', 'PA', 'SGD', 'MLP', 'RF', 'LGBM']
05:31:35 â”‚ ERROR â”‚       âŒ Rule: Prediction failed - sparse array length is ambiguous; use ge...
05:31:35 â”‚ INFO â”‚       âœ…      NB_BOTH: F1=0.000 | ACC=0.481 | PREC=0.000 | REC=0.000 | Time=0.1s
05:31:35 â”‚ INFO â”‚       ğŸ† New best model for keto: NB_BOTH (F1=0.000)
05:31:40 â”‚ INFO â”‚       âœ… Softmax_BOTH: F1=0.444 | ACC=0.615 | PREC=0.889 | REC=0.296 | Time=4.7s
05:31:40 â”‚ INFO â”‚       ğŸ† New best model for keto: Softmax_BOTH (F1=0.444)
05:31:41 â”‚ INFO â”‚ Adding probability calibration to RidgeClassifier
05:31:42 â”‚ INFO â”‚       âœ…   Ridge_BOTH: F1=0.200 | ACC=0.538 | PREC=1.000 | REC=0.111 | Time=2.1s
05:31:46 â”‚ INFO â”‚ Adding probability calibration to PassiveAggressiveClassifier
05:31:54 â”‚ INFO â”‚       âœ…      PA_BOTH: F1=0.312 | ACC=0.577 | PREC=1.000 | REC=0.185 | Time=11.8s
05:31:59 â”‚ INFO â”‚       âœ…     SGD_BOTH: F1=0.412 | ACC=0.615 | PREC=1.000 | REC=0.259 | Time=4.9s
05:32:48 â”‚ INFO â”‚       âœ…     MLP_BOTH: F1=0.500 | ACC=0.654 | PREC=1.000 | REC=0.333 | Time=48.5s
05:32:48 â”‚ INFO â”‚       ğŸ† New best model for keto: MLP_BOTH (F1=0.500)
05:32:48 â”‚ INFO â”‚       âœ…      RF_BOTH: F1=0.412 | ACC=0.615 | PREC=1.000 | REC=0.259 | Time=0.7s
05:32:55 â”‚ INFO â”‚       âœ…    LGBM_BOTH: F1=0.541 | ACC=0.673 | PREC=1.000 | REC=0.370 | Time=6.7s
05:32:55 â”‚ INFO â”‚       ğŸ† New best model for keto: LGBM_BOTH (F1=0.541)
05:32:55 â”‚ INFO â”‚    ğŸ¯ KETO COMPLETE:
05:32:55 â”‚ INFO â”‚    â”œâ”€ Best Model: LGBM_BOTH (F1=0.541)
05:32:55 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.673 | PREC=1.000 | REC=0.370
05:32:55 â”‚ INFO â”‚    â””â”€ Task Time: 80.2s
05:32:55 â”‚ WARNING â”‚ Found 3 NaN values in vegan labels, filling with defaults
05:32:55 â”‚ INFO â”‚ 
ğŸ¯ Processing VEGAN classification:
05:32:55 â”‚ INFO â”‚    Training labels - Positive: 93 (8.0%)
05:32:55 â”‚ INFO â”‚    Test labels - Positive: 28 (53.8%)
05:32:55 â”‚ INFO â”‚    Minority class ratio: 8.0%
05:32:55 â”‚ INFO â”‚    ğŸ”„ Applying SMOTE (minority < 30%)...
05:32:56 â”‚ INFO â”‚    âœ… SMOTE completed in 0.3s
05:32:56 â”‚ INFO â”‚    â”œâ”€ Size: 1,168 â†’ 1,397 (1.2x)
05:32:56 â”‚ INFO â”‚    â””â”€ Minority ratio: 8.0% â†’ 23.0%
05:32:56 â”‚ INFO â”‚    ğŸ¤– Training 9 models: ['Rule', 'NB', 'Softmax', 'Ridge', 'PA', 'SGD', 'MLP', 'RF', 'LGBM']
05:32:56 â”‚ ERROR â”‚       âŒ Rule: Prediction failed - sparse array length is ambiguous; use ge...
05:32:56 â”‚ INFO â”‚       âœ…      NB_BOTH: F1=0.000 | ACC=0.462 | PREC=0.000 | REC=0.000 | Time=0.1s
05:32:56 â”‚ INFO â”‚       ğŸ† New best model for vegan: NB_BOTH (F1=0.000)
05:33:00 â”‚ INFO â”‚       âœ… Softmax_BOTH: F1=0.400 | ACC=0.596 | PREC=1.000 | REC=0.250 | Time=4.6s
05:33:00 â”‚ INFO â”‚       ğŸ† New best model for vegan: Softmax_BOTH (F1=0.400)
05:33:01 â”‚ INFO â”‚ Adding probability calibration to RidgeClassifier
05:33:03 â”‚ INFO â”‚       âœ…   Ridge_BOTH: F1=0.194 | ACC=0.519 | PREC=1.000 | REC=0.107 | Time=2.3s
05:33:06 â”‚ INFO â”‚ Adding probability calibration to PassiveAggressiveClassifier

================================================================================
NEW RUN STARTED AT 2025-06-21 05:33:10
Process ID: 592
================================================================================
05:33:10 â”‚ INFO â”‚ Logging system initialized successfully
05:33:13 â”‚ INFO â”‚       âœ…      PA_BOTH: F1=0.000 | ACC=0.462 | PREC=0.000 | REC=0.000 | Time=9.9s
05:33:18 â”‚ INFO â”‚       âœ…     SGD_BOTH: F1=0.133 | ACC=0.500 | PREC=1.000 | REC=0.071 | Time=4.8s

================================================================================
NEW RUN STARTED AT 2025-06-21 05:33:21
Process ID: 641
================================================================================
05:33:21 â”‚ INFO â”‚ Logging system initialized successfully

================================================================================
NEW RUN STARTED AT 2025-06-21 05:33:54
Process ID: 690
================================================================================
05:33:54 â”‚ INFO â”‚ Logging system initialized successfully
05:34:08 â”‚ INFO â”‚       âœ…     MLP_BOTH: F1=0.194 | ACC=0.519 | PREC=1.000 | REC=0.107 | Time=50.3s
05:34:09 â”‚ INFO â”‚       âœ…      RF_BOTH: F1=0.000 | ACC=0.462 | PREC=0.000 | REC=0.000 | Time=0.7s
05:34:13 â”‚ INFO â”‚       âœ…    LGBM_BOTH: F1=0.250 | ACC=0.538 | PREC=1.000 | REC=0.143 | Time=3.9s
05:34:13 â”‚ INFO â”‚    ğŸ¯ VEGAN COMPLETE:
05:34:13 â”‚ INFO â”‚    â”œâ”€ Best Model: Softmax_BOTH (F1=0.400)
05:34:13 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.596 | PREC=1.000 | REC=0.250
05:34:13 â”‚ INFO â”‚    â””â”€ Task Time: 77.4s
05:34:13 â”‚ INFO â”‚ 
ğŸ MODE A PIPELINE COMPLETE:
05:34:13 â”‚ INFO â”‚    â”œâ”€ Total Time: 157.8s
05:34:13 â”‚ INFO â”‚    â”œâ”€ Tasks Completed: 2
05:34:13 â”‚ INFO â”‚    â””â”€ Domain: both
05:34:13 â”‚ INFO â”‚ 
ğŸ“Š FINAL RESULTS SUMMARY:
05:34:13 â”‚ INFO â”‚    1.  KETO |       LGBM_BOTH | F1=0.541 | ACC=0.673 | Time=6.7s
05:34:13 â”‚ INFO â”‚    2. VEGAN |    Softmax_BOTH | F1=0.400 | ACC=0.596 | Time=4.6s
05:34:13 â”‚ INFO â”‚ 
â•­â”€ MODE A (silver â†’ gold) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
05:34:13 â”‚ INFO â”‚ â”‚ model task     ACC    PREC     REC      F1     ROC      PR â”‚
05:34:13 â”‚ INFO â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
05:34:13 â”‚ INFO â”‚ â”‚ LGBM_BOTH keto     0.67    1.00    0.37    0.54    0.91    0.91 â”‚
05:34:13 â”‚ INFO â”‚ â”‚ Softmax_BOTH vegan    0.60    1.00    0.25    0.40    1.00    1.00 â”‚
05:34:13 â”‚ INFO â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
05:34:13 â”‚ INFO â”‚       âœ… Combined models: 2 results
05:34:13 â”‚ INFO â”‚    ğŸ§¹ Memory cleanup
05:34:13 â”‚ INFO â”‚       â”œâ”€ RAM: 27.8% used (8267 MB)
05:34:13 â”‚ INFO â”‚       â”œâ”€ Objects collected: 47
05:34:13 â”‚ INFO â”‚       âœ… Memory usage normal: 27.8%
05:34:13 â”‚ INFO â”‚    âœ… Model training completed in 249.5s
05:34:13 â”‚ INFO â”‚    ğŸ“Š Total models trained: 6
05:34:13 â”‚ INFO â”‚    ğŸ“Š Model Training - Memory: 27.8% used (8267 MB / 32015 MB)
05:34:13 â”‚ INFO â”‚ 
ğŸ­ STAGE 5: ENSEMBLE OPTIMIZATION
05:34:13 â”‚ INFO â”‚    ğŸ¯ Optimizing keto ensemble...
05:34:13 â”‚ INFO â”‚       â”œâ”€ Available models: 3
05:34:13 â”‚ INFO â”‚ 
ğŸ¯ ENSEMBLE OPTIMIZATION for KETO
05:34:13 â”‚ INFO â”‚    Available models: ['LGBM_IMAGE', 'LGBM_BOTH', 'NB_TEXT']
05:34:13 â”‚ INFO â”‚    Maximum ensemble size: 3
05:34:13 â”‚ INFO â”‚    ğŸ›ï¸  Using default equal weighting for all metrics
05:34:13 â”‚ INFO â”‚    â”œâ”€ Weights: F1=0.167, PREC=0.167, REC=0.167, ROC=0.167, PR=0.167, ACC=0.167
05:34:13 â”‚ INFO â”‚ 
   ğŸ“Š Individual Model Performance:
05:34:13 â”‚ INFO â”‚    â”œâ”€  NB_TEXT: F1=0.963 | Composite=0.961 | ACC=0.970
05:34:13 â”‚ INFO â”‚    â”œâ”€ LGBM_BOTH: F1=0.541 | Composite=0.734 | ACC=0.673
05:34:13 â”‚ INFO â”‚    â”œâ”€ LGBM_IMAGE: F1=0.526 | Composite=0.708 | ACC=0.654
05:34:13 â”‚ INFO â”‚ 
   ğŸ”¬ Testing ensemble sizes 1 to 3...
05:34:13 â”‚ INFO â”‚ 
ğŸ¯ BUILDING TOP-1 ENSEMBLE for KETO
05:34:13 â”‚ INFO â”‚    Target ensemble size: 1 models
05:34:13 â”‚ INFO â”‚    Use saved parameters: False
05:34:13 â”‚ INFO â”‚ 
   ğŸ“Š Model Selection Analysis:
05:34:13 â”‚ INFO â”‚    â”œâ”€ Available models: 3
05:34:13 â”‚ INFO â”‚    â””â”€ Selection criteria: Combined metric scoring
05:34:13 â”‚ INFO â”‚ 
   ğŸ† Top 1 Model Rankings:
05:34:13 â”‚ INFO â”‚     1.    NB_TEXT | F1=0.963 | Composite=5.768 | ACC=0.970
05:34:13 â”‚ INFO â”‚ 
   ğŸ”§ Model Preparation Pipeline:
05:34:13 â”‚ INFO â”‚       â”œâ”€ Processing NB_TEXT (F1=0.963)
05:34:13 â”‚ INFO â”‚          â”œâ”€ Tuning hyperparameters...
05:34:13 â”‚ INFO â”‚             âœ… NB: Using cached model (0ms)
05:34:13 â”‚ ERROR â”‚       âŒ NB_TEXT failed after 0.0s: Found input variables with inconsistent numbers of...
05:34:13 â”‚ INFO â”‚ 
   ğŸ“‹ Preparation Summary:
05:34:13 â”‚ INFO â”‚    â”œâ”€ Successfully prepared: 0/1
05:34:13 â”‚ INFO â”‚    â”œâ”€ Failed preparations: 1
05:34:13 â”‚ INFO â”‚    â””â”€ Total preparation time: 0.0s
05:34:13 â”‚ INFO â”‚    âš ï¸  Failed models:
05:34:13 â”‚ INFO â”‚       â”œâ”€ NB_TEXT: Found input variables with inconsistent numbers of...
05:34:13 â”‚ ERROR â”‚       âŒ n=1: FAILED after 0.2s
05:34:13 â”‚ ERROR â”‚       â””â”€ Error: No models successfully prepared for keto ensemble...
05:34:13 â”‚ INFO â”‚ 
ğŸ¯ BUILDING TOP-2 ENSEMBLE for KETO
05:34:13 â”‚ INFO â”‚    Target ensemble size: 2 models
05:34:13 â”‚ INFO â”‚    Use saved parameters: False
05:34:13 â”‚ INFO â”‚ 
   ğŸ“Š Model Selection Analysis:
05:34:13 â”‚ INFO â”‚    â”œâ”€ Available models: 3
05:34:13 â”‚ INFO â”‚    â””â”€ Selection criteria: Combined metric scoring
05:34:13 â”‚ INFO â”‚ 
   ğŸ† Top 2 Model Rankings:
05:34:13 â”‚ INFO â”‚     1.    NB_TEXT | F1=0.963 | Composite=5.768 | ACC=0.970
05:34:14 â”‚ INFO â”‚     2.  LGBM_BOTH | F1=0.541 | Composite=4.404 | ACC=0.673
05:34:14 â”‚ INFO â”‚ 
   ğŸ”§ Model Preparation Pipeline:
05:34:14 â”‚ INFO â”‚       â”œâ”€ Processing NB_TEXT (F1=0.963)
05:34:14 â”‚ INFO â”‚          â”œâ”€ Tuning hyperparameters...
05:34:14 â”‚ INFO â”‚             âœ… NB: Using cached model (0ms)
05:34:14 â”‚ ERROR â”‚       âŒ NB_TEXT failed after 0.0s: Found input variables with inconsistent numbers of...
05:34:14 â”‚ INFO â”‚       â”œâ”€ Processing LGBM_BOTH (F1=0.541)
05:34:14 â”‚ ERROR â”‚       âŒ LGBM_BOTH failed after 0.0s: 'LGBM'
05:34:14 â”‚ INFO â”‚ 
   ğŸ“‹ Preparation Summary:
05:34:14 â”‚ INFO â”‚    â”œâ”€ Successfully prepared: 0/2
05:34:14 â”‚ INFO â”‚    â”œâ”€ Failed preparations: 2
05:34:14 â”‚ INFO â”‚    â””â”€ Total preparation time: 0.1s
05:34:14 â”‚ INFO â”‚    âš ï¸  Failed models:
05:34:14 â”‚ INFO â”‚       â”œâ”€ NB_TEXT: Found input variables with inconsistent numbers of...
05:34:14 â”‚ INFO â”‚       â”œâ”€ LGBM_BOTH: 'LGBM'
05:34:14 â”‚ ERROR â”‚       âŒ n=2: FAILED after 0.3s
05:34:14 â”‚ ERROR â”‚       â””â”€ Error: No models successfully prepared for keto ensemble...
05:34:14 â”‚ INFO â”‚ 
ğŸ¯ BUILDING TOP-3 ENSEMBLE for KETO
05:34:14 â”‚ INFO â”‚    Target ensemble size: 3 models
05:34:14 â”‚ INFO â”‚    Use saved parameters: False
05:34:14 â”‚ INFO â”‚ 
   ğŸ“Š Model Selection Analysis:
05:34:14 â”‚ INFO â”‚    â”œâ”€ Available models: 3
05:34:14 â”‚ INFO â”‚    â””â”€ Selection criteria: Combined metric scoring
05:34:14 â”‚ INFO â”‚ 
   ğŸ† Top 3 Model Rankings:
05:34:14 â”‚ INFO â”‚     1.    NB_TEXT | F1=0.963 | Composite=5.768 | ACC=0.970
05:34:14 â”‚ INFO â”‚     2.  LGBM_BOTH | F1=0.541 | Composite=4.404 | ACC=0.673
05:34:14 â”‚ INFO â”‚     3. LGBM_IMAGE | F1=0.526 | Composite=4.246 | ACC=0.654
05:34:14 â”‚ INFO â”‚ 
   ğŸ”§ Model Preparation Pipeline:
05:34:14 â”‚ INFO â”‚       â”œâ”€ Processing NB_TEXT (F1=0.963)
05:34:14 â”‚ INFO â”‚          â”œâ”€ Tuning hyperparameters...
05:34:14 â”‚ INFO â”‚             âœ… NB: Using cached model (0ms)
05:34:14 â”‚ ERROR â”‚       âŒ NB_TEXT failed after 0.0s: Found input variables with inconsistent numbers of...
05:34:14 â”‚ INFO â”‚       â”œâ”€ Processing LGBM_BOTH (F1=0.541)
05:34:14 â”‚ ERROR â”‚       âŒ LGBM_BOTH failed after 0.0s: 'LGBM'
05:34:14 â”‚ INFO â”‚       â”œâ”€ Processing LGBM_IMAGE (F1=0.526)
05:34:14 â”‚ ERROR â”‚       âŒ LGBM_IMAGE failed after 0.0s: 'LGBM'
05:34:14 â”‚ INFO â”‚ 
   ğŸ“‹ Preparation Summary:
05:34:14 â”‚ INFO â”‚    â”œâ”€ Successfully prepared: 0/3
05:34:14 â”‚ INFO â”‚    â”œâ”€ Failed preparations: 3
05:34:14 â”‚ INFO â”‚    â””â”€ Total preparation time: 0.1s
05:34:14 â”‚ INFO â”‚    âš ï¸  Failed models:
05:34:14 â”‚ INFO â”‚       â”œâ”€ NB_TEXT: Found input variables with inconsistent numbers of...
05:34:14 â”‚ INFO â”‚       â”œâ”€ LGBM_BOTH: 'LGBM'
05:34:14 â”‚ INFO â”‚       â”œâ”€ LGBM_IMAGE: 'LGBM'
05:34:14 â”‚ ERROR â”‚       âŒ n=3: FAILED after 0.3s
05:34:14 â”‚ ERROR â”‚       â””â”€ Error: No models successfully prepared for keto ensemble...
05:34:14 â”‚ ERROR â”‚ 
   âŒ ENSEMBLE OPTIMIZATION FAILED:
05:34:14 â”‚ ERROR â”‚    â”œâ”€ No valid ensembles found
05:34:14 â”‚ ERROR â”‚    â”œâ”€ Available models: 3
05:34:14 â”‚ ERROR â”‚    â””â”€ Total Time: 1.0s
05:34:14 â”‚ INFO â”‚    ğŸ›¡ï¸  Falling back to best individual model:
05:34:14 â”‚ INFO â”‚    â””â”€ NB_TEXT (F1=0.963)
05:34:14 â”‚ INFO â”‚       âœ… keto ensemble: NB_TEXT (F1=0.963)
05:34:14 â”‚ INFO â”‚    ğŸ¯ Optimizing vegan ensemble...
05:34:14 â”‚ INFO â”‚       â”œâ”€ Available models: 3
05:34:14 â”‚ INFO â”‚ 
ğŸ¯ ENSEMBLE OPTIMIZATION for VEGAN
05:34:14 â”‚ INFO â”‚    Available models: ['MLP_IMAGE', 'Softmax_BOTH', 'NB_TEXT']
05:34:14 â”‚ INFO â”‚    Maximum ensemble size: 3
05:34:14 â”‚ INFO â”‚    ğŸ›ï¸  Using default equal weighting for all metrics
05:34:14 â”‚ INFO â”‚    â”œâ”€ Weights: F1=0.167, PREC=0.167, REC=0.167, ROC=0.167, PR=0.167, ACC=0.167
05:34:14 â”‚ INFO â”‚ 
   ğŸ“Š Individual Model Performance:
05:34:14 â”‚ INFO â”‚    â”œâ”€  NB_TEXT: F1=0.975 | Composite=0.967 | ACC=0.980
05:34:14 â”‚ INFO â”‚    â”œâ”€ MLP_IMAGE: F1=0.526 | Composite=0.756 | ACC=0.654
05:34:14 â”‚ INFO â”‚    â”œâ”€ Softmax_BOTH: F1=0.400 | Composite=0.708 | ACC=0.596
05:34:14 â”‚ INFO â”‚ 
   ğŸ”¬ Testing ensemble sizes 1 to 3...
05:34:14 â”‚ INFO â”‚ 
ğŸ¯ BUILDING TOP-1 ENSEMBLE for VEGAN
05:34:14 â”‚ INFO â”‚    Target ensemble size: 1 models
05:34:14 â”‚ INFO â”‚    Use saved parameters: False
05:34:14 â”‚ INFO â”‚ 
   ğŸ“Š Model Selection Analysis:
05:34:14 â”‚ INFO â”‚    â”œâ”€ Available models: 3
05:34:14 â”‚ INFO â”‚    â””â”€ Selection criteria: Combined metric scoring
05:34:14 â”‚ INFO â”‚ 
   ğŸ† Top 1 Model Rankings:
05:34:14 â”‚ INFO â”‚     1.    NB_TEXT | F1=0.975 | Composite=5.801 | ACC=0.980
05:34:14 â”‚ INFO â”‚ 
   ğŸ”§ Model Preparation Pipeline:
05:34:14 â”‚ INFO â”‚       â”œâ”€ Processing NB_TEXT (F1=0.975)
05:34:14 â”‚ INFO â”‚          â”œâ”€ Tuning hyperparameters...
05:34:14 â”‚ INFO â”‚             âœ… NB: Using cached model (0ms)
05:34:14 â”‚ ERROR â”‚       âŒ NB_TEXT failed after 0.0s: Input y contains NaN.
05:34:14 â”‚ INFO â”‚ 
   ğŸ“‹ Preparation Summary:
05:34:14 â”‚ INFO â”‚    â”œâ”€ Successfully prepared: 0/1
05:34:14 â”‚ INFO â”‚    â”œâ”€ Failed preparations: 1
05:34:14 â”‚ INFO â”‚    â””â”€ Total preparation time: 0.0s
05:34:14 â”‚ INFO â”‚    âš ï¸  Failed models:
05:34:14 â”‚ INFO â”‚       â”œâ”€ NB_TEXT: Input y contains NaN.
05:34:14 â”‚ ERROR â”‚       âŒ n=1: FAILED after 0.2s
05:34:14 â”‚ ERROR â”‚       â””â”€ Error: No models successfully prepared for vegan ensemble...
05:34:14 â”‚ INFO â”‚ 
ğŸ¯ BUILDING TOP-2 ENSEMBLE for VEGAN
05:34:15 â”‚ INFO â”‚    Target ensemble size: 2 models
05:34:15 â”‚ INFO â”‚    Use saved parameters: False
05:34:15 â”‚ INFO â”‚ 
   ğŸ“Š Model Selection Analysis:
05:34:15 â”‚ INFO â”‚    â”œâ”€ Available models: 3
05:34:15 â”‚ INFO â”‚    â””â”€ Selection criteria: Combined metric scoring
05:34:15 â”‚ INFO â”‚ 
   ğŸ† Top 2 Model Rankings:
05:34:15 â”‚ INFO â”‚     1.    NB_TEXT | F1=0.975 | Composite=5.801 | ACC=0.980
05:34:15 â”‚ INFO â”‚     2.  MLP_IMAGE | F1=0.526 | Composite=4.537 | ACC=0.654
05:34:15 â”‚ INFO â”‚ 
   ğŸ”§ Model Preparation Pipeline:
05:34:15 â”‚ INFO â”‚       â”œâ”€ Processing NB_TEXT (F1=0.975)
05:34:15 â”‚ INFO â”‚          â”œâ”€ Tuning hyperparameters...
05:34:15 â”‚ INFO â”‚             âœ… NB: Using cached model (0ms)
05:34:15 â”‚ ERROR â”‚       âŒ NB_TEXT failed after 0.0s: Input y contains NaN.
05:34:15 â”‚ INFO â”‚       â”œâ”€ Processing MLP_IMAGE (F1=0.526)
05:34:15 â”‚ ERROR â”‚       âŒ MLP_IMAGE failed after 0.0s: 'MLP'
05:34:15 â”‚ INFO â”‚ 
   ğŸ“‹ Preparation Summary:
05:34:15 â”‚ INFO â”‚    â”œâ”€ Successfully prepared: 0/2
05:34:15 â”‚ INFO â”‚    â”œâ”€ Failed preparations: 2
05:34:15 â”‚ INFO â”‚    â””â”€ Total preparation time: 0.0s
05:34:15 â”‚ INFO â”‚    âš ï¸  Failed models:
05:34:15 â”‚ INFO â”‚       â”œâ”€ NB_TEXT: Input y contains NaN.
05:34:15 â”‚ INFO â”‚       â”œâ”€ MLP_IMAGE: 'MLP'
05:34:15 â”‚ ERROR â”‚       âŒ n=2: FAILED after 0.3s
05:34:15 â”‚ ERROR â”‚       â””â”€ Error: No models successfully prepared for vegan ensemble...
05:34:15 â”‚ INFO â”‚ 
ğŸ¯ BUILDING TOP-3 ENSEMBLE for VEGAN
05:34:15 â”‚ INFO â”‚    Target ensemble size: 3 models
05:34:15 â”‚ INFO â”‚    Use saved parameters: False
05:34:15 â”‚ INFO â”‚ 
   ğŸ“Š Model Selection Analysis:
05:34:15 â”‚ INFO â”‚    â”œâ”€ Available models: 3
05:34:15 â”‚ INFO â”‚    â””â”€ Selection criteria: Combined metric scoring
05:34:15 â”‚ INFO â”‚ 
   ğŸ† Top 3 Model Rankings:
05:34:15 â”‚ INFO â”‚     1.    NB_TEXT | F1=0.975 | Composite=5.801 | ACC=0.980
05:34:15 â”‚ INFO â”‚     2.  MLP_IMAGE | F1=0.526 | Composite=4.537 | ACC=0.654
05:34:15 â”‚ INFO â”‚     3. Softmax_BOTH | F1=0.400 | Composite=4.246 | ACC=0.596
05:34:15 â”‚ INFO â”‚ 
   ğŸ”§ Model Preparation Pipeline:
05:34:15 â”‚ INFO â”‚       â”œâ”€ Processing NB_TEXT (F1=0.975)
05:34:15 â”‚ INFO â”‚          â”œâ”€ Tuning hyperparameters...
05:34:15 â”‚ INFO â”‚             âœ… NB: Using cached model (0ms)
05:34:15 â”‚ ERROR â”‚       âŒ NB_TEXT failed after 0.0s: Input y contains NaN.
05:34:15 â”‚ INFO â”‚       â”œâ”€ Processing MLP_IMAGE (F1=0.526)
05:34:15 â”‚ ERROR â”‚       âŒ MLP_IMAGE failed after 0.0s: 'MLP'
05:34:15 â”‚ INFO â”‚       â”œâ”€ Processing Softmax_BOTH (F1=0.400)
05:34:15 â”‚ INFO â”‚          â”œâ”€ Tuning hyperparameters...
05:34:15 â”‚ INFO â”‚             âœ… Softmax: Using cached model (0ms)
05:34:15 â”‚ ERROR â”‚       âŒ Softmax_BOTH failed after 0.0s: Input y contains NaN.
05:34:15 â”‚ INFO â”‚ 
   ğŸ“‹ Preparation Summary:
05:34:15 â”‚ INFO â”‚    â”œâ”€ Successfully prepared: 0/3
05:34:15 â”‚ INFO â”‚    â”œâ”€ Failed preparations: 3
05:34:15 â”‚ INFO â”‚    â””â”€ Total preparation time: 0.1s
05:34:15 â”‚ INFO â”‚    âš ï¸  Failed models:
05:34:15 â”‚ INFO â”‚       â”œâ”€ NB_TEXT: Input y contains NaN.
05:34:15 â”‚ INFO â”‚       â”œâ”€ MLP_IMAGE: 'MLP'
05:34:15 â”‚ INFO â”‚       â”œâ”€ Softmax_BOTH: Input y contains NaN.
05:34:15 â”‚ ERROR â”‚       âŒ n=3: FAILED after 0.3s
05:34:15 â”‚ ERROR â”‚       â””â”€ Error: No models successfully prepared for vegan ensemble...
05:34:15 â”‚ ERROR â”‚ 
   âŒ ENSEMBLE OPTIMIZATION FAILED:
05:34:15 â”‚ ERROR â”‚    â”œâ”€ No valid ensembles found
05:34:15 â”‚ ERROR â”‚    â”œâ”€ Available models: 3
05:34:15 â”‚ ERROR â”‚    â””â”€ Total Time: 1.0s
05:34:15 â”‚ INFO â”‚    ğŸ›¡ï¸  Falling back to best individual model:
05:34:15 â”‚ INFO â”‚    â””â”€ NB_TEXT (F1=0.975)
05:34:15 â”‚ INFO â”‚       âœ… vegan ensemble: NB_TEXT (F1=0.975)
05:34:15 â”‚ INFO â”‚    ğŸ“Š Ensemble results: 2 optimized ensembles
05:34:15 â”‚ INFO â”‚ 
   ğŸ”€ Cross-domain ensemble optimization...
05:34:15 â”‚ INFO â”‚       â”œâ”€ Optimizing keto cross-domain ensemble...
05:34:15 â”‚ INFO â”‚ 
ğŸ¯ ENSEMBLE OPTIMIZATION for KETO
05:34:15 â”‚ INFO â”‚    Available models: ['NB_TEXT']
05:34:15 â”‚ INFO â”‚    Maximum ensemble size: 1
05:34:15 â”‚ INFO â”‚    âš ï¸  Only one model available: NB_TEXT
05:34:15 â”‚ INFO â”‚    â””â”€ F1=0.963, skipping ensemble optimization
05:34:15 â”‚ INFO â”‚ 
ğŸ¯ ENSEMBLE OPTIMIZATION for KETO
05:34:15 â”‚ INFO â”‚    Available models: ['LGBM_IMAGE']
05:34:15 â”‚ INFO â”‚    Maximum ensemble size: 1
05:34:15 â”‚ INFO â”‚    âš ï¸  Only one model available: LGBM_IMAGE
05:34:15 â”‚ INFO â”‚    â””â”€ F1=0.526, skipping ensemble optimization
05:34:15 â”‚ INFO â”‚       âœ… keto cross-domain: SmartEns(Text=NB_TEXT,Img=LGBM_IMAGE,alpha=0.25) (F1=0.963)
05:34:15 â”‚ INFO â”‚       â”œâ”€ Optimizing vegan cross-domain ensemble...
05:34:15 â”‚ INFO â”‚ 
ğŸ¯ ENSEMBLE OPTIMIZATION for VEGAN
05:34:15 â”‚ INFO â”‚    Available models: ['NB_TEXT']
05:34:15 â”‚ INFO â”‚    Maximum ensemble size: 1
05:34:15 â”‚ INFO â”‚    âš ï¸  Only one model available: NB_TEXT
05:34:15 â”‚ INFO â”‚    â””â”€ F1=0.975, skipping ensemble optimization
05:34:15 â”‚ INFO â”‚ 
ğŸ¯ ENSEMBLE OPTIMIZATION for VEGAN
05:34:15 â”‚ INFO â”‚    Available models: ['MLP_IMAGE']
05:34:15 â”‚ INFO â”‚    Maximum ensemble size: 1
05:34:15 â”‚ INFO â”‚    âš ï¸  Only one model available: MLP_IMAGE
05:34:15 â”‚ INFO â”‚    â””â”€ F1=0.526, skipping ensemble optimization
05:34:16 â”‚ INFO â”‚       âœ… vegan cross-domain: SmartEns(Text=NB_TEXT,Img=MLP_IMAGE,alpha=0.25) (F1=0.975)
05:34:16 â”‚ INFO â”‚    ğŸ“Š Cross-domain results: 2 optimized ensembles
05:34:16 â”‚ INFO â”‚    âœ… Ensemble optimization completed in 2.5s
05:34:16 â”‚ INFO â”‚    ğŸ“Š Ensemble Creation - Memory: 27.8% used (8267 MB / 32015 MB)
05:34:16 â”‚ INFO â”‚ 
ğŸ“Š STAGE 6: EVALUATION AND EXPORT
05:34:16 â”‚ INFO â”‚    ğŸ“Š Generating evaluation plots...
05:34:16 â”‚ INFO â”‚    âœ… Saved keto confusion matrix to artifacts/confusion_matrix_keto_NB_TEXT.png
05:34:16 â”‚ INFO â”‚    âœ… Saved vegan confusion matrix to artifacts/confusion_matrix_vegan_NB_TEXT.png
05:34:16 â”‚ INFO â”‚    âœ… Saved performance comparison to artifacts/model_performance_comparison.png
05:34:16 â”‚ INFO â”‚       âœ… Generated evaluation plots and confusion matrices
05:34:16 â”‚ INFO â”‚       âœ… Saved results summary with 10 entries
05:34:16 â”‚ INFO â”‚    âœ… Evaluation completed in 0.7s
05:34:16 â”‚ INFO â”‚    ğŸ“Š Final - Memory: 27.8% used (8268 MB / 32015 MB)
05:34:16 â”‚ INFO â”‚ 
ğŸ PIPELINE COMPLETE
05:34:16 â”‚ INFO â”‚    â”œâ”€ Total runtime: 933.2s (15.6 minutes)
05:34:16 â”‚ INFO â”‚    â”œâ”€ Mode: both
05:34:16 â”‚ INFO â”‚    â”œâ”€ Sample fraction: 0.3
05:34:16 â”‚ INFO â”‚    â”œâ”€ Total results: 10
05:34:16 â”‚ INFO â”‚    â””â”€ End time: 2025-06-21 05:34:16
05:34:16 â”‚ INFO â”‚ 
   ğŸ† FINAL PERFORMANCE SUMMARY:
05:34:16 â”‚ INFO â”‚    â”œâ”€ KETO: Best F1=0.963 (NB_TEXT) | ACC=0.970
05:34:16 â”‚ INFO â”‚    â”œâ”€ VEGAN: Best F1=0.975 (NB_TEXT) | ACC=0.980
05:34:16 â”‚ INFO â”‚ 
   ğŸ’¾ RESOURCE USAGE:
05:34:16 â”‚ INFO â”‚    â”œâ”€ Peak memory: 27.8%
05:34:16 â”‚ INFO â”‚    â”œâ”€ Final memory: 8268 MB
05:34:16 â”‚ INFO â”‚    â””â”€ Efficiency: 0.01 models/second
05:34:16 â”‚ INFO â”‚    ğŸ’¾ Saved pipeline metadata to pipeline_metadata.json
05:34:16 â”‚ INFO â”‚ âœ… Pipeline completed with 10 results
05:34:17 â”‚ INFO â”‚ âœ… Saved vectorizer
05:34:17 â”‚ INFO â”‚ âœ… Saved keto single model: NB (F1=0.963)
05:34:17 â”‚ INFO â”‚ âœ… Saved vegan single model: NB (F1=0.975)
05:34:17 â”‚ INFO â”‚ âœ… Saved 2 models to /app/artifacts
05:34:17 â”‚ INFO â”‚ ğŸ Main completed successfully
05:34:17 â”‚ INFO â”‚ ğŸ›‘ Process exiting - no restarts allowed

================================================================================
NEW RUN STARTED AT 2025-06-21 05:34:21
Process ID: 795
================================================================================
05:34:21 â”‚ INFO â”‚ Logging system initialized successfully
05:34:21 â”‚ INFO â”‚ ğŸš€ Starting main with args: Namespace(ground_truth='/app/data/ground_truth_sample.csv', train=False, ingredients=None, mode='both', force=False, sample_frac=None)
05:34:21 â”‚ INFO â”‚ ğŸ“Š Evaluating on ground truth: /app/data/ground_truth_sample.csv
05:34:21 â”‚ INFO â”‚ âœ… Loaded ground truth with 100 rows
05:34:21 â”‚ INFO â”‚ ğŸ“‹ Available columns: ['title', 'description', 'instructions', 'ingredients', 'photo_url', 'vegan', 'keto']
05:34:21 â”‚ INFO â”‚ ğŸ·ï¸  Detected label columns: keto=keto, vegan=vegan
05:34:21 â”‚ INFO â”‚ âœ… Loaded models and vectorizer
05:34:21 â”‚ INFO â”‚    â”œâ”€ keto (both): 42730 features, requires_images=True
05:34:21 â”‚ INFO â”‚    â”œâ”€ vegan (both): 42730 features, requires_images=True
05:34:23 â”‚ INFO â”‚ âœ… Text features shape: (100, 40682)
05:34:23 â”‚ INFO â”‚ 
ğŸ–¼ï¸  Some models require images - preparing combined features...
05:34:23 â”‚ INFO â”‚    â”œâ”€ Rows with valid photo URLs: 66
05:34:23 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: eval_temp
05:34:23 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/eval_temp
05:34:23 â”‚ INFO â”‚    Total samples: 66
05:34:23 â”‚ INFO â”‚    Force recompute: False
05:34:23 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
05:34:23 â”‚ INFO â”‚    âŒ No suitable embeddings found - proceeding with downloads
05:34:23 â”‚ INFO â”‚ 
   ğŸ“‹ DOWNLOAD PLANNING:
05:34:23 â”‚ INFO â”‚       ğŸ“Š Analysis Results:
05:34:23 â”‚ INFO â”‚       â”œâ”€ Total samples: 66
05:34:23 â”‚ INFO â”‚       â”œâ”€ Existing valid files: 0
05:34:23 â”‚ INFO â”‚       â”œâ”€ Corrupted files cleaned: 0
05:34:23 â”‚ INFO â”‚       â”œâ”€ Valid URLs to download: 66
05:34:23 â”‚ INFO â”‚       â”œâ”€ Missing URLs: 0
05:34:23 â”‚ INFO â”‚       â””â”€ Invalid URLs: 0
05:34:23 â”‚ WARNING â”‚    âš ï¸  Large download required: 66 files
05:34:23 â”‚ INFO â”‚       â””â”€ This may take a while...
05:34:23 â”‚ INFO â”‚    ğŸ¯ Download Queue: 66 files
05:34:23 â”‚ INFO â”‚ 
   ğŸš€ EXECUTING ROBUST DOWNLOADS:
05:34:25 â”‚ INFO â”‚ 
   ğŸ“Š DOWNLOAD RESULTS:
05:34:25 â”‚ INFO â”‚    â”œâ”€ Processing time: 2.0s
05:34:25 â”‚ INFO â”‚    â”œâ”€ Files downloaded: 66
05:34:25 â”‚ INFO â”‚    â”œâ”€ Files skipped: 0
05:34:25 â”‚ INFO â”‚    â”œâ”€ Download failures: 0
05:34:25 â”‚ INFO â”‚    â”œâ”€ Retry attempts: 0
05:34:25 â”‚ INFO â”‚    â””â”€ Data transferred: 2.1 MB
05:34:25 â”‚ INFO â”‚ 
   ğŸ“ˆ SUCCESS METRICS:
05:34:25 â”‚ INFO â”‚    â”œâ”€ Download success rate: 100.0%
05:34:25 â”‚ INFO â”‚    â”œâ”€ Total valid files: 66
05:34:25 â”‚ INFO â”‚    â”œâ”€ Coverage: 100.0% of dataset
05:34:25 â”‚ INFO â”‚    âœ… ACCEPTABLE COVERAGE - proceeding with 66 images
05:34:25 â”‚ INFO â”‚ 
ğŸ§  IMAGE EMBEDDING EXTRACTION: eval_temp
05:34:25 â”‚ INFO â”‚    Target images: 66
05:34:25 â”‚ INFO â”‚    Mode: eval_temp
05:34:25 â”‚ INFO â”‚    Force recomputation: False
05:34:25 â”‚ INFO â”‚    ğŸ”§ Device Configuration:
05:34:25 â”‚ INFO â”‚    â”œâ”€ Device: cpu
05:34:25 â”‚ INFO â”‚    â”œâ”€ CUDA available: False
05:34:25 â”‚ INFO â”‚    â””â”€ Using CPU (warning: much slower)
05:34:25 â”‚ INFO â”‚    ğŸ“ Paths:
05:34:25 â”‚ INFO â”‚    â”œâ”€ Image directory: dataset/arg_max/images/eval_temp
05:34:25 â”‚ INFO â”‚    â”œâ”€ Cache file: dataset/arg_max/images/eval_temp/embeddings.npy
05:34:25 â”‚ INFO â”‚    â””â”€ Backup file: /app/artifacts/embeddings_eval_temp_backup.npy
05:34:25 â”‚ INFO â”‚ 
   ğŸ” Cache Validation:
05:34:25 â”‚ INFO â”‚       â”œâ”€ Artifacts backup: Not found
05:34:25 â”‚ INFO â”‚       â”œâ”€ Primary cache: Not found
05:34:25 â”‚ INFO â”‚       â”œâ”€ Legacy backup: Not found
05:34:25 â”‚ INFO â”‚       â””â”€ No valid cache found - will compute embeddings
05:34:25 â”‚ INFO â”‚ 
   ğŸ“Š Pre-processing Analysis:
05:34:25 â”‚ INFO â”‚       ğŸ“ˆ Image Availability:
05:34:25 â”‚ INFO â”‚       â”œâ”€ Total expected: 66
05:34:25 â”‚ INFO â”‚       â”œâ”€ Available: 66 (100.0%)
05:34:25 â”‚ INFO â”‚       â”œâ”€ Missing: 0 (0.0%)
05:34:25 â”‚ INFO â”‚       â””â”€ Corrupted: 0 (0.0%)
05:34:26 â”‚ INFO â”‚       ğŸ“Š Sample Analysis (10 images):
05:34:26 â”‚ INFO â”‚       â”œâ”€ Average size: 529Ã—308 pixels
05:34:26 â”‚ INFO â”‚       â”œâ”€ Average file size: 39.1 KB
05:34:26 â”‚ INFO â”‚       â”œâ”€ Color modes: {'RGB': 10}
05:34:26 â”‚ INFO â”‚       â””â”€ Formats: {'JPEG': 10}
05:34:26 â”‚ INFO â”‚ 
   ğŸ¤– Model Setup:
05:34:26 â”‚ INFO â”‚       âœ… Model loaded in 0.20s
05:34:26 â”‚ INFO â”‚       â”œâ”€ Architecture: ResNet-50 (feature extractor)
05:34:26 â”‚ INFO â”‚       â”œâ”€ Output dimension: 2048
05:34:26 â”‚ INFO â”‚       â”œâ”€ Device: cpu
05:34:26 â”‚ INFO â”‚       â””â”€ Parameters: 23,508,032
05:34:26 â”‚ INFO â”‚ 
   âš¡ Feature Extraction:
05:34:26 â”‚ INFO â”‚       ğŸ”§ Processing Configuration:
05:34:26 â”‚ INFO â”‚       â”œâ”€ Batch size: 8
05:34:26 â”‚ INFO â”‚       â”œâ”€ Total batches: 9
05:34:26 â”‚ INFO â”‚       â””â”€ Expected output shape: (66, 2048)
05:34:27 â”‚ INFO â”‚ 
   ğŸ“Š Extraction Results:
05:34:28 â”‚ INFO â”‚    â”œâ”€ Total processing time: 2.3s
05:34:28 â”‚ INFO â”‚    â”œâ”€ Successfully processed: 66
05:34:28 â”‚ INFO â”‚    â”œâ”€ Missing images: 0
05:34:28 â”‚ INFO â”‚    â”œâ”€ Failed processing: 0
05:34:28 â”‚ INFO â”‚    â””â”€ Overall success rate: 100.0%
05:34:28 â”‚ INFO â”‚    âš¡ Performance Metrics:
05:34:28 â”‚ INFO â”‚    â”œâ”€ Average processing time: 0.024s per image
05:34:28 â”‚ INFO â”‚    â”œâ”€ Throughput: 29.2 images/second
05:34:28 â”‚ INFO â”‚    â””â”€ Device efficiency: cpu
05:34:28 â”‚ INFO â”‚ 
   ğŸ’¾ Saving Results:
05:34:28 â”‚ INFO â”‚    ğŸ’¾ Metadata saved to: dataset/arg_max/images/eval_temp/embedding_metadata.json
05:34:28 â”‚ INFO â”‚    ğŸ“Š File Information:
05:34:28 â”‚ INFO â”‚    â”œâ”€ Primary cache: 0.5 MB (dataset/arg_max/images/eval_temp/embeddings.npy)
05:34:28 â”‚ INFO â”‚    â”œâ”€ Backup cache: 0.5 MB (/app/artifacts/embeddings_eval_temp_backup.npy)
05:34:28 â”‚ INFO â”‚    â””â”€ Array shape: (66, 2048)
05:34:28 â”‚ INFO â”‚ 
   ğŸ EMBEDDING EXTRACTION COMPLETE:
05:34:28 â”‚ INFO â”‚    â”œâ”€ Output shape: (66, 2048)
05:34:28 â”‚ INFO â”‚    â”œâ”€ Success rate: 100.0%
05:34:28 â”‚ INFO â”‚    â”œâ”€ Total time: 2.3s
05:34:28 â”‚ INFO â”‚    â”œâ”€ Throughput: 29.2 images/s
05:34:28 â”‚ INFO â”‚    â””â”€ Files saved: Primary + Backup + Metadata
05:34:28 â”‚ INFO â”‚       â”œâ”€ Quality filtering: 52/66 images kept
05:34:28 â”‚ INFO â”‚    ğŸ“Š Quality filtering reduced images from 66 to 52
05:34:28 â”‚ INFO â”‚    âœ… Extracted embeddings for 52 images
05:34:28 â”‚ INFO â”‚    âœ… Created combined features: (100, 42730)
05:34:28 â”‚ INFO â”‚ 
ğŸ”® Making predictions...
05:34:28 â”‚ INFO â”‚ âœ… Saved predictions to /app/artifacts/ground_truth_predictions.csv
05:34:28 â”‚ INFO â”‚ 
ğŸ“Š Calculating evaluation metrics...
05:34:28 â”‚ INFO â”‚ âœ… KETO - ACC: 0.660 | PREC: 0.650 | REC: 0.325 | F1: 0.433 | N: 100
05:34:28 â”‚ INFO â”‚    Confusion Matrix for keto:
05:34:28 â”‚ INFO â”‚    [[TN=53, FP=7],
05:34:28 â”‚ INFO â”‚     [FN=27, TP=13]]
05:34:28 â”‚ INFO â”‚    Predictions: 20 positive, 80 negative
05:34:28 â”‚ INFO â”‚    True labels: 40 positive, 60 negative
05:34:28 â”‚ INFO â”‚ âœ… VEGAN - ACC: 0.600 | PREC: 0.500 | REC: 0.250 | F1: 0.333 | N: 100
05:34:28 â”‚ INFO â”‚    Confusion Matrix for vegan:
05:34:28 â”‚ INFO â”‚    [[TN=50, FP=10],
05:34:28 â”‚ INFO â”‚     [FN=30, TP=10]]
05:34:28 â”‚ INFO â”‚    Predictions: 20 positive, 80 negative
05:34:28 â”‚ INFO â”‚    True labels: 40 positive, 60 negative
05:34:28 â”‚ INFO â”‚ ğŸ“ˆ Saved evaluation metrics to /app/artifacts/eval_metrics.csv
05:34:28 â”‚ INFO â”‚ 
ğŸ¯ EVALUATION SUMMARY:
05:34:28 â”‚ INFO â”‚    KETO: F1=0.433, Accuracy=0.660, Samples=100
05:34:28 â”‚ INFO â”‚    VEGAN: F1=0.333, Accuracy=0.600, Samples=100
05:34:28 â”‚ INFO â”‚ ğŸ Main completed successfully
05:34:28 â”‚ INFO â”‚ ğŸ›‘ Process exiting - no restarts allowed

================================================================================
NEW RUN STARTED AT 2025-06-21 05:34:32
Process ID: 866
================================================================================
05:34:32 â”‚ INFO â”‚ Logging system initialized successfully
05:34:32 â”‚ INFO â”‚ ğŸš€ Starting main with args: Namespace(ground_truth=None, train=False, ingredients='almond flour, erythritol, egg whites', mode='both', force=False, sample_frac=None)
05:34:32 â”‚ INFO â”‚ Loaded vectorizer + models from /app/artifacts
05:34:34 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
05:34:34 â”‚ INFO â”‚ Carb map initialised (303 keys)
05:34:34 â”‚ INFO â”‚ {"keto": false, "vegan": false}
05:34:34 â”‚ INFO â”‚ ğŸ›‘ Process exiting - no restarts allowed
