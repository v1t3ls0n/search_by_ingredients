
================================================================================
NEW RUN STARTED AT 2025-06-29 01:55:09
Process ID: 103
================================================================================
01:55:09 â”‚ INFO â”‚ Logging system initialized successfully

================================================================================
NEW RUN STARTED AT 2025-06-29 01:55:09
Process ID: 36
================================================================================
01:55:09 â”‚ INFO â”‚ Logging system initialized successfully
01:55:11 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
01:55:11 â”‚ INFO â”‚ Carb map initialised (303 keys)
01:55:11 â”‚ INFO â”‚ âœ… All sanity checks passed
01:55:11 â”‚ INFO â”‚ ğŸš€ Starting main with args: Namespace(ground_truth=None, train=True, ingredients=None, mode='both', force=False, sample_frac=1.0)
01:55:11 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
01:55:11 â”‚ INFO â”‚ Safe memory limit (90%): 28.1 GB
01:55:11 â”‚ INFO â”‚ ğŸ’¾ Available memory for processing: 28.1 GB
01:55:11 â”‚ WARNING â”‚ âš ï¸  Limited memory detected. Enabling memory optimizations...
01:55:11 â”‚ INFO â”‚ ğŸš€ Starting main with args: Namespace(ground_truth=None, train=True, ingredients=None, mode='both', force=False, sample_frac=1.0)
01:55:11 â”‚ INFO â”‚ ğŸ§  SINGLE training run - sample_frac=1.0
01:55:11 â”‚ INFO â”‚ ğŸš€ STARTING FULL ML PIPELINE
01:55:11 â”‚ INFO â”‚    Mode: both
01:55:11 â”‚ INFO â”‚    Force recomputation: False
01:55:11 â”‚ INFO â”‚    Sample fraction: 1.0
01:55:11 â”‚ INFO â”‚    Start time: 2025-06-29 01:55:11
01:55:11 â”‚ INFO â”‚    Available CPU cores: 24
01:55:11 â”‚ INFO â”‚    Available memory: 31 GB
01:55:11 â”‚ INFO â”‚ 
ğŸ“‚ STAGE 1: DATA LOADING AND PREPARATION
01:55:11 â”‚ INFO â”‚ 
ğŸ“‚ DATASET LOADING PIPELINE
01:55:11 â”‚ INFO â”‚    Configuration: 2 data sources
01:55:11 â”‚ INFO â”‚    Data directory: /app/data
01:55:11 â”‚ INFO â”‚    ğŸ“Š Data Sources:
01:55:11 â”‚ INFO â”‚    â”œâ”€ allrecipes.parquet: Local
01:55:11 â”‚ INFO â”‚    â”‚  â””â”€ /app/data/allrecipes.parquet
01:55:11 â”‚ INFO â”‚    â”œâ”€ ground_truth_sample.csv: Local
01:55:11 â”‚ INFO â”‚    â”‚  â””â”€ /app/data/ground_truth_sample.csv
01:55:11 â”‚ INFO â”‚ 
   ğŸ³ STAGE 1: LOADING RECIPES DATASET
01:55:11 â”‚ INFO â”‚    â”œâ”€ Source: /app/data/allrecipes.parquet
01:55:11 â”‚ INFO â”‚       â”œâ”€ Local file size: 49.2 MB
01:55:11 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
01:55:11 â”‚ INFO â”‚ Carb map initialised (303 keys)
01:55:11 â”‚ INFO â”‚ âœ… All sanity checks passed
01:55:12 â”‚ INFO â”‚       ğŸ“Š Recipes Dataset:
01:55:12 â”‚ INFO â”‚       â”œâ”€ Shape: (225602, 5)
01:55:12 â”‚ INFO â”‚       â”œâ”€ Columns: ['title', 'description', 'instructions', 'ingredients', 'photo_url']
01:55:12 â”‚ INFO â”‚       â”œâ”€ Memory usage: 145.4 MB
01:55:12 â”‚ INFO â”‚       â””â”€ Load time: 0.5s

================================================================================
NEW RUN STARTED AT 2025-06-29 01:55:14
Process ID: 160
================================================================================
01:55:14 â”‚ INFO â”‚ Logging system initialized successfully
01:55:15 â”‚ INFO â”‚       ğŸ“ˆ Data Quality:
01:55:15 â”‚ INFO â”‚       â”œâ”€ Total recipes: 225,602
01:55:15 â”‚ INFO â”‚       â”œâ”€ Null ingredients: 0
01:55:15 â”‚ INFO â”‚       â”œâ”€ Empty ingredients: 0
01:55:15 â”‚ INFO â”‚       â””â”€ With photos: 225,602 (100.0%)
01:55:15 â”‚ INFO â”‚    âœ… Recipes loaded successfully in 4.0s
01:55:15 â”‚ INFO â”‚       ğŸ’¾ Recipes loaded: 17.5% memory used (4982 MB / 32015 MB)
01:55:15 â”‚ INFO â”‚ 
   ğŸ¯ STAGE 2: LOADING GROUND TRUTH DATASET
01:55:15 â”‚ INFO â”‚    â”œâ”€ Source: /app/data/ground_truth_sample.csv
01:55:15 â”‚ INFO â”‚       â”œâ”€ File size: 79.1 KB
01:55:15 â”‚ INFO â”‚       ğŸ“Š Ground Truth Dataset:
01:55:15 â”‚ INFO â”‚       â”œâ”€ Shape: (100, 7)
01:55:15 â”‚ INFO â”‚       â”œâ”€ Columns: ['title', 'description', 'instructions', 'ingredients', 'photo_url', 'vegan', 'keto']
01:55:15 â”‚ INFO â”‚       â”œâ”€ Keto columns found: ['keto']
01:55:15 â”‚ INFO â”‚       â”œâ”€ Vegan columns found: ['vegan']
01:55:15 â”‚ INFO â”‚       â””â”€ Load time: 0.00s
01:55:15 â”‚ INFO â”‚       â”œâ”€ Keto labels: 40/100 (40.0% positive)
01:55:15 â”‚ INFO â”‚       â”œâ”€ Vegan labels: 40/100 (40.0% positive)
01:55:15 â”‚ INFO â”‚    âœ… Ground truth loaded successfully in 0.1s
01:55:15 â”‚ INFO â”‚       ğŸ’¾ Ground truth loaded: 17.5% memory used (4998 MB / 32015 MB)
01:55:15 â”‚ INFO â”‚ 
   ğŸ¥ˆ STAGE 3: GENERATING SILVER LABELS
01:55:16 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
01:55:16 â”‚ INFO â”‚ Carb map initialised (303 keys)
01:55:16 â”‚ INFO â”‚ âœ… All sanity checks passed
01:56:56 â”‚ INFO â”‚       ğŸ“Š Silver Labels Generated:
01:56:56 â”‚ INFO â”‚       â”œâ”€ Total recipes: 225,602
01:56:56 â”‚ INFO â”‚       â”œâ”€ Keto positive: 36,722 (16.3%)
01:56:56 â”‚ INFO â”‚       â”œâ”€ Vegan positive: 16,378 (7.3%)
01:56:56 â”‚ INFO â”‚       â”œâ”€ With photos: 225,602 (100.0%)
01:56:56 â”‚ INFO â”‚       â””â”€ Generation time: 100.9s
01:56:56 â”‚ INFO â”‚    âœ… Silver labels generated successfully in 101.0s
01:56:56 â”‚ INFO â”‚       ğŸ’¾ Silver labels generated: 17.8% memory used (5098 MB / 32015 MB)
01:56:56 â”‚ INFO â”‚ 
   âœ… STAGE 4: DATA VALIDATION AND CROSS-CHECKS
01:56:57 â”‚ INFO â”‚       ğŸ’¾ Memory Usage by Dataset:
01:56:57 â”‚ INFO â”‚       â”œâ”€ Recipes: 145.4 MB
01:56:57 â”‚ INFO â”‚       â”œâ”€ Silver: 106.4 MB
01:56:57 â”‚ INFO â”‚       â”œâ”€ Ground_truth: 0.1 MB
01:56:57 â”‚ INFO â”‚       â””â”€ Total: 251.9 MB
01:56:57 â”‚ INFO â”‚       ğŸ“Š Label Distribution Comparison:
01:56:57 â”‚ INFO â”‚       â”œâ”€ Keto: Gold=40.0%, Silver=16.3%
01:56:57 â”‚ INFO â”‚       â””â”€ Vegan: Gold=40.0%, Silver=7.3%
01:56:57 â”‚ WARNING â”‚       âš ï¸  Large keto distribution difference: 23.7%
01:56:57 â”‚ WARNING â”‚       âš ï¸  Large vegan distribution difference: 32.7%
01:56:57 â”‚ INFO â”‚       âœ… Validation Summary:
01:56:57 â”‚ INFO â”‚       â”œâ”€ Recipes Loaded: âœ…
01:56:57 â”‚ INFO â”‚       â”œâ”€ Ground Truth Loaded: âœ…
01:56:57 â”‚ INFO â”‚       â”œâ”€ Silver Generated: âœ…
01:56:57 â”‚ INFO â”‚       â”œâ”€ Required Columns Present: âœ…
01:56:57 â”‚ INFO â”‚       â”œâ”€ Labels Processed: âœ…
01:56:57 â”‚ INFO â”‚       â”œâ”€ Consistency Issues: 0
01:56:57 â”‚ INFO â”‚    âœ… Data validation completed in 0.4s
01:56:57 â”‚ INFO â”‚       ğŸ’¾ Validation complete: 17.9% memory used (5118 MB / 32015 MB)
01:56:57 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
01:56:57 â”‚ INFO â”‚    âœ… USDA table loaded in 0.1s â€“ 303 rows
01:56:57 â”‚ INFO â”‚ 
ğŸ DATASET LOADING COMPLETE
01:56:57 â”‚ INFO â”‚    â”œâ”€ Total loading time: 105.8s
01:56:57 â”‚ INFO â”‚    â”œâ”€ Datasets loaded: 4 (recipes, ground_truth, silver, usda)
01:56:57 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
01:56:57 â”‚ INFO â”‚    â””â”€ All validations passed: âœ…
01:56:57 â”‚ INFO â”‚ 
   ğŸ“‹ Final Dataset Summary:
01:56:57 â”‚ INFO â”‚    â”œâ”€ Recipes: 225,602 rows Ã— 5 columns
01:56:57 â”‚ INFO â”‚    â”œâ”€ Ground Truth: 100 rows Ã— 10 columns
01:56:57 â”‚ INFO â”‚    â”œâ”€ Silver Labels: 225,602 rows Ã— 5 columns
01:56:57 â”‚ INFO â”‚    â”œâ”€ USDA Carb Tbl:  303 rows Ã— 2 columns (0.0 MB)
01:56:57 â”‚ INFO â”‚    â”œâ”€ Total memory usage: 251.9 MB
01:56:57 â”‚ INFO â”‚    â””â”€ Ready for ML pipeline: âœ…
01:56:57 â”‚ INFO â”‚ 
   ğŸ“Š Dataset Statistics:
01:56:57 â”‚ INFO â”‚    â”œâ”€ Silver (All): 225,602 recipes
01:56:57 â”‚ INFO â”‚    â”œâ”€ Silver (Text): 225,602 recipes
01:56:57 â”‚ INFO â”‚    â”œâ”€ Silver (Images): 72,485 recipes
01:56:57 â”‚ INFO â”‚    â”œâ”€ Gold (All): 100 recipes
01:56:57 â”‚ INFO â”‚    â””â”€ Gold (Images): 66 recipes
01:56:57 â”‚ INFO â”‚ 
   âš–ï¸  Class Balance Analysis:
01:56:57 â”‚ INFO â”‚ 
â”€â”€ Gold set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
01:56:57 â”‚ INFO â”‚  keto:     40/100 (40.0%)
01:56:57 â”‚ INFO â”‚ vegan:     40/100 (40.0%)
01:56:57 â”‚ INFO â”‚ 
â”€â”€ Silver (Text) set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
01:56:58 â”‚ INFO â”‚  keto:  36722/225602 (16.3%)
01:56:58 â”‚ INFO â”‚ vegan:  16378/225602 ( 7.3%)
01:56:58 â”‚ INFO â”‚ 
â”€â”€ Silver (Image) set set class counts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
01:56:58 â”‚ INFO â”‚  keto:  28518/72485 (39.3%)
01:56:58 â”‚ INFO â”‚ vegan:  12577/72485 (17.4%)
01:56:58 â”‚ INFO â”‚    âœ… Data loading completed in 106.4s
01:56:58 â”‚ INFO â”‚    ğŸ“Š Data Loading - Memory: 18.0% used (5151 MB / 32015 MB)
01:56:58 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
01:56:58 â”‚ INFO â”‚ Safe memory limit (100%): 31.3 GB
01:56:58 â”‚ INFO â”‚    ğŸ§¹ Data Loading: Memory optimization
01:56:58 â”‚ INFO â”‚       â”œâ”€ Container/System memory: 31.3 GB total
01:56:58 â”‚ INFO â”‚       â”œâ”€ Currently used: 18.0% (5151 MB)
01:56:58 â”‚ INFO â”‚       âœ… Memory usage normal: 18.0%
01:56:58 â”‚ INFO â”‚ 
ğŸ”¤ STAGE 2: TEXT FEATURE PROCESSING
01:56:58 â”‚ INFO â”‚    â”œâ”€ Vectorizer config: {'min_df': 2, 'ngram_range': (1, 3), 'max_features': 50000, 'sublinear_tf': True}
01:56:58 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
01:56:58 â”‚ INFO â”‚    â”œâ”€ USDA examples added: 303
01:57:11 â”‚ INFO â”‚    ğŸ“Š Text Processing Results:
01:57:11 â”‚ INFO â”‚    â”œâ”€ Vocabulary size: 50,000
01:57:11 â”‚ INFO â”‚    â”œâ”€ Silver features: (225905, 50000)
01:57:11 â”‚ INFO â”‚    â”œâ”€ Gold features: (100, 50000)
01:57:11 â”‚ INFO â”‚    â”œâ”€ Sparsity: 0.0%
01:57:11 â”‚ INFO â”‚    â””â”€ Memory usage: ~103 MB
01:57:11 â”‚ INFO â”‚    âœ… Text processing completed in 13.4s
01:57:11 â”‚ INFO â”‚    ğŸ“Š Text Processing - Memory: 18.8% used (5409 MB / 32015 MB)
01:57:11 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
01:57:11 â”‚ INFO â”‚ Safe memory limit (100%): 31.3 GB
01:57:11 â”‚ INFO â”‚    ğŸ§¹ Text Processing: Memory optimization
01:57:12 â”‚ INFO â”‚       â”œâ”€ Container/System memory: 31.3 GB total
01:57:12 â”‚ INFO â”‚       â”œâ”€ Currently used: 18.8% (5409 MB)
01:57:12 â”‚ INFO â”‚       âœ… Memory usage normal: 18.8%
01:57:12 â”‚ INFO â”‚ 
ğŸ–¼ï¸  STAGE 3: IMAGE FEATURE PROCESSING
01:57:12 â”‚ INFO â”‚    â”œâ”€ Processing 72,485 sampled silver images
01:57:12 â”‚ INFO â”‚    â””â”€ Processing 66 gold images
01:57:12 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: silver
01:57:12 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/silver
01:57:12 â”‚ INFO â”‚    Total samples: 72,485
01:57:12 â”‚ INFO â”‚    Force recompute: False
01:57:12 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
01:57:12 â”‚ INFO â”‚    âœ… EMBEDDINGS FOUND: /app/artifacts/embeddings_silver_backup.npy
01:57:12 â”‚ INFO â”‚       â”œâ”€ Shape: (72422, 2048)
01:57:12 â”‚ INFO â”‚       â”œâ”€ Coverage: 99.9% (72,422/72,485)
01:57:12 â”‚ INFO â”‚       â”œâ”€ File size: 565.8 MB
01:57:12 â”‚ INFO â”‚       â””â”€ ğŸš€ SKIPPING IMAGE DOWNLOADS!
01:57:12 â”‚ INFO â”‚       â”œâ”€ Silver download: 72,422/72,485 successful
01:57:12 â”‚ INFO â”‚ 
ğŸ§  EMBEDDINGS-FIRST IMAGE PIPELINE: gold
01:57:12 â”‚ INFO â”‚    Target directory: dataset/arg_max/images/gold
01:57:12 â”‚ INFO â”‚    Total samples: 66
01:57:12 â”‚ INFO â”‚    Force recompute: False
01:57:12 â”‚ INFO â”‚    ğŸ” Searching for existing embeddings...
01:57:12 â”‚ INFO â”‚    âœ… EMBEDDINGS FOUND: /app/artifacts/embeddings_gold_backup.npy
01:57:12 â”‚ INFO â”‚       â”œâ”€ Shape: (66, 2048)
01:57:12 â”‚ INFO â”‚       â”œâ”€ Coverage: 100.0% (66/66)
01:57:12 â”‚ INFO â”‚       â”œâ”€ File size: 0.5 MB
01:57:12 â”‚ INFO â”‚       â””â”€ ğŸš€ SKIPPING IMAGE DOWNLOADS!
01:57:12 â”‚ INFO â”‚       â”œâ”€ Gold download: 66/66 successful
01:57:12 â”‚ INFO â”‚       â”œâ”€ Silver filtered: 72,422 with valid images
01:57:12 â”‚ INFO â”‚       â”œâ”€ Gold filtered: 66 with valid images
01:57:12 â”‚ INFO â”‚       â”œâ”€ Gold filtered: 66 with valid images
01:57:12 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
01:57:12 â”‚ INFO â”‚ Safe memory limit (90%): 28.1 GB
01:57:12 â”‚ INFO â”‚    ğŸ’¾ Memory-aware batch size: 16 (based on 28.1 GB available)
01:57:12 â”‚ INFO â”‚ 
ğŸ§  IMAGE EMBEDDING EXTRACTION: silver
01:57:12 â”‚ INFO â”‚    Target images: 72,422
01:57:12 â”‚ INFO â”‚    Mode: silver
01:57:12 â”‚ INFO â”‚    Force recomputation: False
01:57:12 â”‚ INFO â”‚    ğŸ”§ Device Configuration:
01:57:12 â”‚ INFO â”‚    â”œâ”€ Device: cpu
01:57:12 â”‚ INFO â”‚    â”œâ”€ CUDA available: False
01:57:14 â”‚ INFO â”‚    âœ… Using cached embeddings from Artifacts backup
01:57:14 â”‚ INFO â”‚       â”œâ”€ Silver embeddings: (72422, 2048)
01:57:14 â”‚ INFO â”‚       â”œâ”€ Silver DataFrame: 72,422 rows
01:57:14 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
01:57:14 â”‚ INFO â”‚ Safe memory limit (90%): 28.1 GB
01:57:14 â”‚ INFO â”‚    ğŸ’¾ Memory-aware batch size: 16 (based on 28.1 GB available)
01:57:14 â”‚ INFO â”‚ 
ğŸ§  IMAGE EMBEDDING EXTRACTION: gold
01:57:14 â”‚ INFO â”‚    Target images: 66
01:57:14 â”‚ INFO â”‚    Mode: gold
01:57:14 â”‚ INFO â”‚    Force recomputation: False
01:57:14 â”‚ INFO â”‚    ğŸ”§ Device Configuration:
01:57:14 â”‚ INFO â”‚    â”œâ”€ Device: cpu
01:57:14 â”‚ INFO â”‚    â”œâ”€ CUDA available: False
01:57:14 â”‚ INFO â”‚    âœ… Using cached embeddings from Artifacts backup
01:57:14 â”‚ INFO â”‚       â”œâ”€ Gold embeddings: (66, 2048)
01:57:14 â”‚ INFO â”‚       â”œâ”€ Gold DataFrame: 66 rows
01:57:14 â”‚ INFO â”‚       â”œâ”€ Saved gold embeddings to embeddings/img_gold.pkl
01:57:15 â”‚ INFO â”‚       â”œâ”€ Saved silver embeddings to embeddings/img_silver.pkl
01:57:15 â”‚ INFO â”‚    ğŸ” DIMENSION VERIFICATION:
01:57:15 â”‚ INFO â”‚    â”œâ”€ Silver embeddings: (72422, 2048)
01:57:15 â”‚ INFO â”‚    â”œâ”€ Silver DataFrame: 72,422 rows
01:57:15 â”‚ INFO â”‚    â”œâ”€ Gold embeddings: (66, 2048)
01:57:15 â”‚ INFO â”‚    â””â”€ Gold DataFrame: 66 rows
01:57:16 â”‚ INFO â”‚    ğŸ“Š Image Processing Results:
01:57:16 â”‚ INFO â”‚    â”œâ”€ Silver images available: 72,485
01:57:16 â”‚ INFO â”‚    â”œâ”€ Silver images downloaded: 72,422
01:57:16 â”‚ INFO â”‚    â”œâ”€ Silver valid embeddings: 72,422
01:57:16 â”‚ INFO â”‚    â”œâ”€ Gold images available: 66
01:57:16 â”‚ INFO â”‚    â”œâ”€ Gold images downloaded: 66
01:57:16 â”‚ INFO â”‚    â”œâ”€ Gold valid embeddings: 66
01:57:16 â”‚ INFO â”‚    â”œâ”€ Silver embedding size: 565 MB
01:57:16 â”‚ INFO â”‚    â””â”€ Gold embedding size: 0 MB
01:57:16 â”‚ INFO â”‚    âœ… Image processing completed in 4.5s
01:57:16 â”‚ INFO â”‚    ğŸ“Š Image Processing - Memory: 21.8% used (6366 MB / 32015 MB)
01:57:16 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
01:57:16 â”‚ INFO â”‚ Safe memory limit (100%): 31.3 GB
01:57:16 â”‚ INFO â”‚    ğŸ§¹ Image Processing: Memory optimization
01:57:17 â”‚ INFO â”‚       â”œâ”€ Container/System memory: 31.3 GB total
01:57:17 â”‚ INFO â”‚       â”œâ”€ Currently used: 21.8% (6366 MB)
01:57:17 â”‚ INFO â”‚       â”œâ”€ Freed: 0.0 MB RAM
01:57:17 â”‚ INFO â”‚       â”œâ”€ Objects collected: 44
01:57:17 â”‚ INFO â”‚       âœ… Memory usage normal: 21.8%
01:57:17 â”‚ INFO â”‚ 
ğŸ¤– STAGE 4: MODEL TRAINING
01:57:17 â”‚ INFO â”‚    ğŸ–¼ï¸  Training image-based models...
01:57:17 â”‚ INFO â”‚    ğŸ“Š Mode='both' detected - using combined text+image features
01:57:21 â”‚ INFO â”‚       â”œâ”€ Combined features for image models: (72422, 52048)
01:57:21 â”‚ INFO â”‚       â”œâ”€ Samples: 72422 silver, 66 gold
01:57:21 â”‚ INFO â”‚ ğŸš€ Starting MODE A Training Pipeline
01:57:21 â”‚ INFO â”‚    Domain: image
01:57:21 â”‚ INFO â”‚    SMOTE enabled: False
01:57:21 â”‚ INFO â”‚    Silver set size: 72,422
01:57:21 â”‚ INFO â”‚    Gold set size: 66
01:57:21 â”‚ INFO â”‚    Feature dimensions: (72422, 52048)
01:57:21 â”‚ INFO â”‚ 
ğŸ“Š Class Distribution Analysis:
01:57:21 â”‚ INFO â”‚     Keto - Silver: 11,786/72,422 (16.3%) | Gold: 34/66 (51.5%)
01:57:21 â”‚ INFO â”‚    Vegan - Silver: 5,224.0/72,422 (7.2%) | Gold: 35/66 (53.0%)
01:57:21 â”‚ INFO â”‚ 
ğŸ¯ Processing KETO classification:
01:57:21 â”‚ INFO â”‚    Training labels - Positive: 11,786 (16.3%)
01:57:21 â”‚ INFO â”‚    Test labels - Positive: 34 (51.5%)
01:57:21 â”‚ INFO â”‚    â­ï¸  SMOTE disabled, using original data
01:57:21 â”‚ INFO â”‚    ğŸ¤– Training 2 models: ['RF', 'LGBM']
01:57:25 â”‚ INFO â”‚       âœ…     RF_IMAGE: F1=0.957 | ACC=0.955 | PREC=0.943 | REC=0.971 | Time=4.0s
01:57:25 â”‚ INFO â”‚       ğŸ† New best model for keto: RF_IMAGE (F1=0.957)

================================================================================
NEW RUN STARTED AT 2025-06-29 01:58:23
Process ID: 286
================================================================================
01:58:24 â”‚ INFO â”‚ Logging system initialized successfully
01:58:26 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
01:58:26 â”‚ INFO â”‚ Carb map initialised (303 keys)
01:58:26 â”‚ INFO â”‚ âœ… All sanity checks passed
01:58:42 â”‚ INFO â”‚       âœ…   LGBM_IMAGE: F1=0.957 | ACC=0.955 | PREC=0.943 | REC=0.971 | Time=76.7s
01:58:42 â”‚ INFO â”‚    ğŸ¯ KETO COMPLETE:
01:58:42 â”‚ INFO â”‚    â”œâ”€ Best Model: RF_IMAGE (F1=0.957)
01:58:42 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.955 | PREC=0.943 | REC=0.971
01:58:42 â”‚ INFO â”‚    â””â”€ Task Time: 80.9s
01:58:42 â”‚ INFO â”‚ 
ğŸ¯ Processing VEGAN classification:
01:58:42 â”‚ INFO â”‚    Training labels - Positive: 5,224 (7.2%)
01:58:42 â”‚ INFO â”‚    Test labels - Positive: 35 (53.0%)
01:58:42 â”‚ INFO â”‚    â­ï¸  SMOTE disabled, using original data
01:58:42 â”‚ INFO â”‚    ğŸ¤– Training 2 models: ['RF', 'LGBM']
01:58:46 â”‚ INFO â”‚       âœ…     RF_IMAGE: F1=0.986 | ACC=0.985 | PREC=0.972 | REC=1.000 | Time=4.3s
01:58:46 â”‚ INFO â”‚       ğŸ† New best model for vegan: RF_IMAGE (F1=0.986)

================================================================================
NEW RUN STARTED AT 2025-06-29 01:58:48
Process ID: 362
================================================================================
01:58:48 â”‚ INFO â”‚ Logging system initialized successfully
01:58:50 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
01:58:50 â”‚ INFO â”‚ Carb map initialised (303 keys)
01:58:50 â”‚ INFO â”‚ âœ… All sanity checks passed
01:59:39 â”‚ INFO â”‚       âœ…   LGBM_IMAGE: F1=0.986 | ACC=0.985 | PREC=0.972 | REC=1.000 | Time=52.1s
01:59:39 â”‚ INFO â”‚    ğŸ¯ VEGAN COMPLETE:
01:59:39 â”‚ INFO â”‚    â”œâ”€ Best Model: RF_IMAGE (F1=0.986)
01:59:39 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.985 | PREC=0.972 | REC=1.000
01:59:39 â”‚ INFO â”‚    â””â”€ Task Time: 56.5s
01:59:39 â”‚ INFO â”‚    ğŸ“Š Saved model metrics to /app/artifacts/metrics/model_metrics_image_20250629_015939.csv
01:59:39 â”‚ INFO â”‚    ğŸ† Saved best models to /app/artifacts/metrics/best_models_image_20250629_015939.csv
01:59:39 â”‚ INFO â”‚    ğŸ“‹ Saved training metadata to /app/artifacts/metrics/training_metadata_image_20250629_015939.csv
01:59:39 â”‚ INFO â”‚    ğŸ“ˆ Saved model comparison to /app/artifacts/metrics/model_comparison_image_20250629_015939.csv
01:59:39 â”‚ INFO â”‚    ğŸ”® Saved model predictions to /app/artifacts/metrics/model_predictions_image_20250629_015939.csv
01:59:39 â”‚ INFO â”‚ 
ğŸ MODE A PIPELINE COMPLETE:
01:59:39 â”‚ INFO â”‚    â”œâ”€ Total Time: 137.5s
01:59:39 â”‚ INFO â”‚    â”œâ”€ Tasks Completed: 2
01:59:39 â”‚ INFO â”‚    â”œâ”€ Models Trained: 6
01:59:39 â”‚ INFO â”‚    â””â”€ Domain: image
01:59:39 â”‚ INFO â”‚ 
ğŸ“Š ALL RESULTS:
01:59:39 â”‚ INFO â”‚     1.  KETO |        RF_IMAGE | F1=0.957 | ACC=0.955 | Time=4.0s
01:59:39 â”‚ INFO â”‚     2.  KETO |        RF_IMAGE | F1=0.957 | ACC=0.955 | Time=4.0s
01:59:39 â”‚ INFO â”‚     3.  KETO |      LGBM_IMAGE | F1=0.957 | ACC=0.955 | Time=76.7s
01:59:39 â”‚ INFO â”‚     4. VEGAN |        RF_IMAGE | F1=0.986 | ACC=0.985 | Time=4.3s
01:59:39 â”‚ INFO â”‚     5. VEGAN |        RF_IMAGE | F1=0.986 | ACC=0.985 | Time=4.3s
01:59:39 â”‚ INFO â”‚     6. VEGAN |      LGBM_IMAGE | F1=0.986 | ACC=0.985 | Time=52.1s
01:59:39 â”‚ INFO â”‚ 
â•­â”€ MODE A (silver â†’ gold) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
01:59:39 â”‚ INFO â”‚ â”‚ model task     ACC    PREC     REC      F1     ROC      PR â”‚
01:59:39 â”‚ INFO â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
01:59:39 â”‚ INFO â”‚ â”‚ RF_IMAGE keto     0.95    0.94    0.97    0.96    0.96    0.96 â”‚
01:59:39 â”‚ INFO â”‚ â”‚ RF_IMAGE keto     0.95    0.94    0.97    0.96    0.96    0.96 â”‚
01:59:39 â”‚ INFO â”‚ â”‚ LGBM_IMAGE keto     0.95    0.94    0.97    0.96    0.96    0.96 â”‚
01:59:39 â”‚ INFO â”‚ â”‚ RF_IMAGE vegan    0.98    0.97    1.00    0.99    0.97    0.91 â”‚
01:59:39 â”‚ INFO â”‚ â”‚ RF_IMAGE vegan    0.98    0.97    1.00    0.99    0.97    0.91 â”‚
01:59:39 â”‚ INFO â”‚ â”‚ LGBM_IMAGE vegan    0.98    0.97    1.00    0.99    0.97    0.95 â”‚
01:59:39 â”‚ INFO â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
01:59:39 â”‚ INFO â”‚       âœ… Image models: 6 results
01:59:39 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
01:59:39 â”‚ INFO â”‚ Safe memory limit (100%): 31.3 GB
01:59:39 â”‚ INFO â”‚    ğŸ§¹ Image Models: Memory optimization
01:59:39 â”‚ INFO â”‚       â”œâ”€ Container/System memory: 31.3 GB total
01:59:39 â”‚ INFO â”‚       â”œâ”€ Currently used: 32.0% (9620 MB)
01:59:39 â”‚ INFO â”‚       â”œâ”€ Freed: 0.0 MB RAM
01:59:39 â”‚ INFO â”‚       â”œâ”€ Objects collected: 8
01:59:39 â”‚ INFO â”‚       âœ… Memory usage normal: 32.0%
01:59:39 â”‚ INFO â”‚    ğŸ”¤ Training text-based models...
01:59:39 â”‚ INFO â”‚ ğŸš€ Starting MODE A Training Pipeline
01:59:39 â”‚ INFO â”‚    Domain: text
01:59:39 â”‚ INFO â”‚    SMOTE enabled: True
01:59:40 â”‚ INFO â”‚    Silver set size: 225,905
01:59:40 â”‚ INFO â”‚    Gold set size: 100
01:59:40 â”‚ INFO â”‚    Feature dimensions: (225905, 50000)
01:59:40 â”‚ INFO â”‚ 
ğŸ“Š Class Distribution Analysis:
01:59:40 â”‚ INFO â”‚     Keto - Silver: 36,885/225,905 (16.3%) | Gold: 40/100 (40.0%)
01:59:40 â”‚ INFO â”‚    Vegan - Silver: 16,378.0/225,905 (7.2%) | Gold: 40/100 (40.0%)
01:59:40 â”‚ INFO â”‚ 
ğŸ¯ Processing KETO classification:
01:59:40 â”‚ INFO â”‚    Training labels - Positive: 36,885 (16.3%)
01:59:40 â”‚ INFO â”‚    Test labels - Positive: 40 (40.0%)
01:59:40 â”‚ INFO â”‚    Minority class ratio: 16.3%
01:59:40 â”‚ INFO â”‚    ğŸ”„ Applying SMOTE (minority < 30%)...
01:59:40 â”‚ INFO â”‚    âœ… SMOTE completed in 0.1s
01:59:40 â”‚ INFO â”‚    â”œâ”€ Size: 225,905 â†’ 378,040 (1.7x)
01:59:40 â”‚ INFO â”‚    â””â”€ Minority ratio: 16.3% â†’ 50.0%
01:59:40 â”‚ INFO â”‚    ğŸ¤– Training 6 models: ['NB', 'Softmax', 'Ridge', 'PA', 'SGD', 'LinearSVC']
01:59:40 â”‚ INFO â”‚       âœ…      NB_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=0.1s
01:59:40 â”‚ INFO â”‚       ğŸ† New best model for keto: NB_TEXT (F1=0.963)
01:59:45 â”‚ INFO â”‚       âœ… Softmax_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=4.6s
01:59:51 â”‚ INFO â”‚ Adding probability calibration to RidgeClassifier
02:00:06 â”‚ INFO â”‚       âœ…   Ridge_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=21.2s
02:00:07 â”‚ INFO â”‚ Adding probability calibration to PassiveAggressiveClassifier
02:00:12 â”‚ INFO â”‚       âœ…      PA_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=6.3s
02:00:13 â”‚ INFO â”‚       âœ…     SGD_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=1.2s
02:00:19 â”‚ INFO â”‚ Adding probability calibration to LinearSVC
02:00:33 â”‚ INFO â”‚       âœ… LinearSVC_TEXT: F1=0.963 | ACC=0.970 | PREC=0.951 | REC=0.975 | Time=20.1s
02:00:33 â”‚ INFO â”‚    ğŸ¯ KETO COMPLETE:
02:00:33 â”‚ INFO â”‚    â”œâ”€ Best Model: NB_TEXT (F1=0.963)
02:00:33 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.970 | PREC=0.951 | REC=0.975
02:00:33 â”‚ INFO â”‚    â””â”€ Task Time: 53.7s
02:00:33 â”‚ WARNING â”‚ Found 303 NaN values in vegan labels, filling with defaults
02:00:33 â”‚ INFO â”‚ 
ğŸ¯ Processing VEGAN classification:
02:00:33 â”‚ INFO â”‚    Training labels - Positive: 16,681 (7.4%)
02:00:33 â”‚ INFO â”‚    Test labels - Positive: 40 (40.0%)
02:00:33 â”‚ INFO â”‚    Minority class ratio: 7.4%
02:00:33 â”‚ INFO â”‚    ğŸ”„ Applying SMOTE (minority < 30%)...
02:00:33 â”‚ INFO â”‚    âœ… SMOTE completed in 0.1s
02:00:34 â”‚ INFO â”‚    â”œâ”€ Size: 225,905 â†’ 418,448 (1.9x)
02:00:34 â”‚ INFO â”‚    â””â”€ Minority ratio: 7.4% â†’ 50.0%
02:00:34 â”‚ INFO â”‚    ğŸ¤– Training 6 models: ['NB', 'Softmax', 'Ridge', 'PA', 'SGD', 'LinearSVC']
02:00:34 â”‚ INFO â”‚       âœ…      NB_TEXT: F1=0.975 | ACC=0.980 | PREC=0.975 | REC=0.975 | Time=0.1s
02:00:34 â”‚ INFO â”‚       ğŸ† New best model for vegan: NB_TEXT (F1=0.975)
02:00:37 â”‚ INFO â”‚       âœ… Softmax_TEXT: F1=0.975 | ACC=0.980 | PREC=0.975 | REC=0.975 | Time=3.5s
02:00:45 â”‚ INFO â”‚ Adding probability calibration to RidgeClassifier
02:01:02 â”‚ INFO â”‚       âœ…   Ridge_TEXT: F1=0.975 | ACC=0.980 | PREC=0.975 | REC=0.975 | Time=24.7s
02:01:03 â”‚ INFO â”‚ Adding probability calibration to PassiveAggressiveClassifier
02:01:09 â”‚ INFO â”‚       âœ…      PA_TEXT: F1=0.975 | ACC=0.980 | PREC=0.975 | REC=0.975 | Time=6.8s
02:01:10 â”‚ INFO â”‚       âœ…     SGD_TEXT: F1=0.962 | ACC=0.970 | PREC=0.974 | REC=0.950 | Time=1.2s
02:01:17 â”‚ INFO â”‚ Adding probability calibration to LinearSVC
02:01:38 â”‚ INFO â”‚       âœ… LinearSVC_TEXT: F1=0.975 | ACC=0.980 | PREC=0.975 | REC=0.975 | Time=27.7s
02:01:38 â”‚ INFO â”‚    ğŸ¯ VEGAN COMPLETE:
02:01:38 â”‚ INFO â”‚    â”œâ”€ Best Model: NB_TEXT (F1=0.975)
02:01:38 â”‚ INFO â”‚    â”œâ”€ Final Metrics: ACC=0.980 | PREC=0.975 | REC=0.975
02:01:38 â”‚ INFO â”‚    â””â”€ Task Time: 64.4s
02:01:38 â”‚ INFO â”‚    ğŸ“Š Saved model metrics to /app/artifacts/metrics/model_metrics_text_20250629_020138.csv
02:01:38 â”‚ INFO â”‚    ğŸ† Saved best models to /app/artifacts/metrics/best_models_text_20250629_020138.csv
02:01:38 â”‚ INFO â”‚    ğŸ“‹ Saved training metadata to /app/artifacts/metrics/training_metadata_text_20250629_020138.csv
02:01:38 â”‚ INFO â”‚    ğŸ“ˆ Saved model comparison to /app/artifacts/metrics/model_comparison_text_20250629_020138.csv
02:01:38 â”‚ INFO â”‚    ğŸ”® Saved model predictions to /app/artifacts/metrics/model_predictions_text_20250629_020138.csv
02:01:38 â”‚ INFO â”‚ 
ğŸ MODE A PIPELINE COMPLETE:
02:01:38 â”‚ INFO â”‚    â”œâ”€ Total Time: 118.3s
02:01:38 â”‚ INFO â”‚    â”œâ”€ Tasks Completed: 2
02:01:38 â”‚ INFO â”‚    â”œâ”€ Models Trained: 14
02:01:38 â”‚ INFO â”‚    â””â”€ Domain: text
02:01:38 â”‚ INFO â”‚ 
ğŸ“Š ALL RESULTS:
02:01:38 â”‚ INFO â”‚     1.  KETO |         NB_TEXT | F1=0.963 | ACC=0.970 | Time=0.1s
02:01:38 â”‚ INFO â”‚     2.  KETO |         NB_TEXT | F1=0.963 | ACC=0.970 | Time=0.1s
02:01:38 â”‚ INFO â”‚     3.  KETO |    Softmax_TEXT | F1=0.963 | ACC=0.970 | Time=4.6s
02:01:38 â”‚ INFO â”‚     4.  KETO |      Ridge_TEXT | F1=0.963 | ACC=0.970 | Time=21.2s
02:01:38 â”‚ INFO â”‚     5.  KETO |         PA_TEXT | F1=0.963 | ACC=0.970 | Time=6.3s
02:01:38 â”‚ INFO â”‚     6.  KETO |        SGD_TEXT | F1=0.963 | ACC=0.970 | Time=1.2s
02:01:38 â”‚ INFO â”‚     7.  KETO |  LinearSVC_TEXT | F1=0.963 | ACC=0.970 | Time=20.1s
02:01:38 â”‚ INFO â”‚     8. VEGAN |         NB_TEXT | F1=0.975 | ACC=0.980 | Time=0.1s
02:01:38 â”‚ INFO â”‚     9. VEGAN |         NB_TEXT | F1=0.975 | ACC=0.980 | Time=0.1s
02:01:38 â”‚ INFO â”‚    10. VEGAN |    Softmax_TEXT | F1=0.975 | ACC=0.980 | Time=3.5s
02:01:38 â”‚ INFO â”‚    11. VEGAN |      Ridge_TEXT | F1=0.975 | ACC=0.980 | Time=24.7s
02:01:38 â”‚ INFO â”‚    12. VEGAN |         PA_TEXT | F1=0.975 | ACC=0.980 | Time=6.8s
02:01:38 â”‚ INFO â”‚    13. VEGAN |        SGD_TEXT | F1=0.962 | ACC=0.970 | Time=1.2s
02:01:38 â”‚ INFO â”‚    14. VEGAN |  LinearSVC_TEXT | F1=0.975 | ACC=0.980 | Time=27.7s
02:01:38 â”‚ INFO â”‚ 
â•­â”€ MODE A (silver â†’ gold) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
02:01:38 â”‚ INFO â”‚ â”‚ model task     ACC    PREC     REC      F1     ROC      PR â”‚
02:01:38 â”‚ INFO â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
02:01:38 â”‚ INFO â”‚ â”‚ NB_TEXT keto     0.97    0.95    0.97    0.96    0.97    0.94 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ NB_TEXT keto     0.97    0.95    0.97    0.96    0.97    0.94 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ Softmax_TEXT keto     0.97    0.95    0.97    0.96    0.98    0.98 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ Ridge_TEXT keto     0.97    0.95    0.97    0.96    0.98    0.96 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ PA_TEXT keto     0.97    0.95    0.97    0.96    0.98    0.96 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ SGD_TEXT keto     0.97    0.95    0.97    0.96    0.98    0.97 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ LinearSVC_TEXT keto     0.97    0.95    0.97    0.96    0.98    0.96 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ NB_TEXT vegan    0.98    0.97    0.97    0.97    0.97    0.93 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ NB_TEXT vegan    0.98    0.97    0.97    0.97    0.97    0.93 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ Softmax_TEXT vegan    0.98    0.97    0.97    0.97    0.98    0.98 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ Ridge_TEXT vegan    0.98    0.97    0.97    0.97    0.99    0.98 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ PA_TEXT vegan    0.98    0.97    0.97    0.97    0.99    0.98 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ SGD_TEXT vegan    0.97    0.97    0.95    0.96    0.97    0.94 â”‚
02:01:38 â”‚ INFO â”‚ â”‚ LinearSVC_TEXT vegan    0.98    0.97    0.97    0.97    0.99    0.98 â”‚
02:01:38 â”‚ INFO â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
02:01:38 â”‚ INFO â”‚       âœ… Text models: 14 results
02:01:38 â”‚ INFO â”‚ System/Container total memory: 31.3 GB
02:01:38 â”‚ INFO â”‚ Safe memory limit (100%): 31.3 GB
02:01:38 â”‚ INFO â”‚    ğŸ§¹ Text Models: Memory optimization
02:01:38 â”‚ INFO â”‚       â”œâ”€ Container/System memory: 31.3 GB total
02:01:38 â”‚ INFO â”‚       â”œâ”€ Currently used: 34.6% (10451 MB)
02:01:39 â”‚ INFO â”‚       â”œâ”€ Freed: 0.0 MB RAM
02:01:39 â”‚ INFO â”‚       â”œâ”€ Objects collected: 50
02:01:39 â”‚ INFO â”‚       âœ… Memory usage normal: 34.6%
02:01:39 â”‚ INFO â”‚    ğŸ¤ Creating text+image ensemble...
02:01:39 â”‚ INFO â”‚       â”œâ”€ keto: Testing alpha values [0.25, 0.5, 0.75]
02:01:39 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (keto) â€” text=NB_TEXT (F1=0.963), image=RF_IMAGE
02:01:39 â”‚ INFO â”‚    â”œâ”€ Text predictions: 100 samples
02:01:39 â”‚ INFO â”‚    â”œâ”€ Image predictions: 66 samples
02:01:39 â”‚ INFO â”‚    â””â”€ Blending with alpha=0.25
02:01:39 â”‚ ERROR â”‚          âŒ alpha=0.25 failed: 'NB'...
02:01:39 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (keto) â€” text=NB_TEXT (F1=0.963), image=RF_IMAGE
02:01:39 â”‚ INFO â”‚    â”œâ”€ Text predictions: 100 samples
02:01:39 â”‚ INFO â”‚    â”œâ”€ Image predictions: 66 samples
02:01:39 â”‚ INFO â”‚    â””â”€ Blending with alpha=0.5
02:01:39 â”‚ ERROR â”‚          âŒ alpha=0.5 failed: 'NB'...
02:01:39 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (keto) â€” text=NB_TEXT (F1=0.963), image=RF_IMAGE
02:01:39 â”‚ INFO â”‚    â”œâ”€ Text predictions: 100 samples
02:01:39 â”‚ INFO â”‚    â”œâ”€ Image predictions: 66 samples
02:01:39 â”‚ INFO â”‚    â””â”€ Blending with alpha=0.75
02:01:39 â”‚ ERROR â”‚          âŒ alpha=0.75 failed: 'NB'...
02:01:39 â”‚ WARNING â”‚       âš ï¸  Ensemble failed for keto, using best text model
02:01:39 â”‚ INFO â”‚       â”œâ”€ vegan: Testing alpha values [0.25, 0.5, 0.75]
02:01:39 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (vegan) â€” text=NB_TEXT (F1=0.975), image=RF_IMAGE
02:01:39 â”‚ INFO â”‚    â”œâ”€ Text predictions: 100 samples
02:01:39 â”‚ INFO â”‚    â”œâ”€ Image predictions: 66 samples
02:01:39 â”‚ INFO â”‚    â””â”€ Blending with alpha=0.25
02:01:39 â”‚ ERROR â”‚          âŒ alpha=0.25 failed: 'NB'...
02:01:39 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (vegan) â€” text=NB_TEXT (F1=0.975), image=RF_IMAGE
02:01:39 â”‚ INFO â”‚    â”œâ”€ Text predictions: 100 samples
02:01:39 â”‚ INFO â”‚    â”œâ”€ Image predictions: 66 samples
02:01:39 â”‚ INFO â”‚    â””â”€ Blending with alpha=0.5
02:01:39 â”‚ ERROR â”‚          âŒ alpha=0.5 failed: 'NB'...
02:01:39 â”‚ INFO â”‚ â–¶ï¸  BEST-TWO (vegan) â€” text=NB_TEXT (F1=0.975), image=RF_IMAGE
02:01:39 â”‚ INFO â”‚    â”œâ”€ Text predictions: 100 samples
02:01:39 â”‚ INFO â”‚    â”œâ”€ Image predictions: 66 samples
02:01:39 â”‚ INFO â”‚    â””â”€ Blending with alpha=0.75
02:01:39 â”‚ ERROR â”‚          âŒ alpha=0.75 failed: 'NB'...
02:01:39 â”‚ WARNING â”‚       âš ï¸  Ensemble failed for vegan, using best text model
02:01:39 â”‚ INFO â”‚ 
â•­â”€ Text+Image Ensembles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
02:01:39 â”‚ INFO â”‚ â”‚ model task     ACC    PREC     REC      F1     ROC      PR â”‚
02:01:39 â”‚ INFO â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
02:01:39 â”‚ INFO â”‚ â”‚ NB_TEXT keto     0.97    0.95    0.97    0.96    0.97    0.94 â”‚
02:01:39 â”‚ INFO â”‚ â”‚ NB_TEXT vegan    0.98    0.97    0.97    0.97    0.97    0.93 â”‚
02:01:39 â”‚ INFO â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
02:01:39 â”‚ INFO â”‚       âœ… Created 2 ensemble configurations
02:01:39 â”‚ INFO â”‚    ğŸ”„ Training final combined models...
02:01:44 â”‚ INFO â”‚       â”œâ”€ Combined silver features: (72422, 52048)
02:01:44 â”‚ INFO â”‚       â”œâ”€ Combined gold features: (66, 52048)
02:01:44 â”‚ INFO â”‚       â”œâ”€ Silver samples: 72,422
02:01:44 â”‚ INFO â”‚       â””â”€ Gold samples: 66
02:01:44 â”‚ INFO â”‚ ğŸš€ Starting MODE A Training Pipeline
02:01:44 â”‚ INFO â”‚    Domain: both
02:01:44 â”‚ INFO â”‚    SMOTE enabled: True
02:01:44 â”‚ INFO â”‚    Silver set size: 72,422
02:01:44 â”‚ INFO â”‚    Gold set size: 66
02:01:44 â”‚ INFO â”‚    Feature dimensions: (72422, 52048)
02:01:44 â”‚ INFO â”‚ 
ğŸ“Š Class Distribution Analysis:
02:01:44 â”‚ INFO â”‚     Keto - Silver: 11,786/72,422 (16.3%) | Gold: 34/66 (51.5%)
02:01:44 â”‚ INFO â”‚    Vegan - Silver: 5,224.0/72,422 (7.2%) | Gold: 35/66 (53.0%)
02:01:44 â”‚ INFO â”‚ 
ğŸ¯ Processing KETO classification:
02:01:44 â”‚ INFO â”‚    Training labels - Positive: 11,786 (16.3%)
02:01:44 â”‚ INFO â”‚    Test labels - Positive: 34 (51.5%)
02:01:44 â”‚ INFO â”‚    Minority class ratio: 16.3%
02:01:44 â”‚ INFO â”‚    ğŸ”„ Applying SMOTE (minority < 30%)...
02:01:45 â”‚ INFO â”‚    âœ… SMOTE completed in 0.5s
02:01:45 â”‚ INFO â”‚    â”œâ”€ Size: 72,422 â†’ 121,272 (1.7x)
02:01:45 â”‚ INFO â”‚    â””â”€ Minority ratio: 16.3% â†’ 50.0%
02:01:45 â”‚ INFO â”‚    ğŸ¤– Training 8 models: ['NB', 'Softmax', 'Ridge', 'PA', 'SGD', 'LinearSVC', 'RF', 'LGBM']
02:01:45 â”‚ INFO â”‚       âœ…      NB_BOTH: F1=0.957 | ACC=0.955 | PREC=0.943 | REC=0.971 | Time=0.4s
02:01:45 â”‚ INFO â”‚       ğŸ† New best model for keto: NB_BOTH (F1=0.957)

================================================================================
NEW RUN STARTED AT 2025-06-29 02:01:48
Process ID: 471
================================================================================
02:01:48 â”‚ INFO â”‚ Logging system initialized successfully
02:01:50 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
02:01:50 â”‚ INFO â”‚ Carb map initialised (303 keys)
02:01:50 â”‚ INFO â”‚ âœ… All sanity checks passed
02:04:32 â”‚ INFO â”‚       âœ… Softmax_BOTH: F1=0.941 | ACC=0.939 | PREC=0.941 | REC=0.941 | Time=166.9s

================================================================================
NEW RUN STARTED AT 2025-06-29 02:04:33
Process ID: 521
================================================================================
02:04:33 â”‚ INFO â”‚ Logging system initialized successfully
02:04:35 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
02:04:35 â”‚ INFO â”‚ Carb map initialised (303 keys)
02:04:35 â”‚ INFO â”‚ âœ… All sanity checks passed

================================================================================
NEW RUN STARTED AT 2025-06-29 02:06:45
Process ID: 570
================================================================================
02:06:45 â”‚ INFO â”‚ Logging system initialized successfully
02:06:47 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
02:06:47 â”‚ INFO â”‚ Carb map initialised (303 keys)
02:06:47 â”‚ INFO â”‚ âœ… All sanity checks passed

================================================================================
NEW RUN STARTED AT 2025-06-29 02:07:38
Process ID: 619
================================================================================
02:07:38 â”‚ INFO â”‚ Logging system initialized successfully
02:07:40 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
02:07:41 â”‚ INFO â”‚ Carb map initialised (303 keys)
02:07:41 â”‚ INFO â”‚ âœ… All sanity checks passed

================================================================================
NEW RUN STARTED AT 2025-06-29 02:08:05
Process ID: 668
================================================================================
02:08:05 â”‚ INFO â”‚ Logging system initialized successfully
02:08:07 â”‚ INFO â”‚ USDA carb table loaded: 303 distinct food descriptions
02:08:07 â”‚ INFO â”‚ Carb map initialised (303 keys)
02:08:07 â”‚ INFO â”‚ âœ… All sanity checks passed
